'use strict';var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("object"!=(void 0===console?'undefined':_typeof(console)))var console={info:function(e){window.status=e}};var runTime={remainTimer:0,waitOpenTimer:0,getLastOpenTimer:0,scollTopIntervalTimer:0,traceRemainTimer:0,traceWaitOpenTimer:0,buyTodayTimer:0,clearAll:function(){clearInterval(runTime.remainTimer),clearInterval(runTime.waitOpenTimer),clearInterval(runTime.getLastOpenTimer),clearInterval(runTime.scollTopIntervalTimer),clearInterval(runTime.traceRemainTimer),clearInterval(runTime.traceWaitOpenTimer),clearInterval(runTime.buyTodayTimer)}};!function($){$.init=function(settings){function todayGetCurIssue(e){if(e.code){for(var t="",a=0;a<e.code.length;a++)"<b>"+e.code[a]+"</b>",t+=e.code[a];$("#todayIssuesBody").prepend('<ul class="fix"><li style="width:30%">'+e.issue+'</li><li style="width:70%"><b>'+t.split(' ').join('</b><b>')+'</b></li></ul>'),$('#todayIssuesBody').children().last().remove()}}function subTime(e){var t=e>0?{day:Math.floor(e/86400),hour:Math.floor(e%86400/3600),minute:Math.floor(e%3600/60),second:Math.floor(e%60)}:{day:0,hour:0,minute:0,second:0};return 1==(t.hour+"").length&&(t.hour="0"+t.hour),1==(t.minute+"").length&&(t.minute="0"+t.minute),1==(t.second+"").length&&(t.second="0"+t.second),t}function allHasValue(e){var t=1,a=0;return $.each(e,function(e,n){a+=n.length,0==n.length&&(t=0)}),{flag:t,charsNum:a}}var verifyParams=function(){var e=0;return void 0==settings.lotteryId||!is_numeric(settings.lotteryId)||settings.lotteryId<=0?e=-1:void 0==settings.lotteryName||''==settings.lotteryName?e=-2:void 0!=settings.lotteryType&&is_numeric(settings.lotteryType)&&-1!=$.inArray(settings.lotteryType,[1,2,4,5,6,7,8,9])?void 0!=settings.methods&&$.isArray(settings.methods)&&0!=settings.methods.length?void 0!=settings.openedIssues&&$.isArray(settings.openedIssues)&&0!=settings.openedIssues.length?void 0!=settings.minRebateGaps&&$.isArray(settings.minRebateGaps)&&0!=settings.minRebateGaps.length?void 0==settings.rebate||!is_numeric(settings.rebate)||settings.rebate<0||settings.rebate>.178?e=-7:void 0!=settings.defaultMode&&is_numeric(settings.defaultMode)&&-1!=!$.inArray(settings.defaultMode,[.5])?void 0==settings.defaultRebate||!is_numeric(settings.defaultRebate)||settings.defaultRebate<0||settings.defaultRebate>settings.rebate?e=-9:(void 0==settings.maxCombPrize||!is_numeric(settings.maxCombPrize)||settings.maxCombPrize<=0)&&(e=-10):e=-8:e=-6:e=-5:e=-4:e=-3,e<0&&console.info('参数错误：flag='+e),0==e},ps=$.extend({counter:0,lotteryId:1,lotteryName:'CQSSC',lotteryType:1,property_id:1,methods:[],maxCombPrize:0,openedIssues:[],minRebateGaps:[{from:0,to:.12,gap:.005},{from:.12,to:.125,gap:.001}],rebate:.123,defaultMode:.5,defaultRebate:.123,missHot:{miss:[],hot:[]},halt:function(e){throw alert(e+'!'),e},prizeRate:0,curIssueInfo:{},lastIssueInfo:{},curMode:.5,curMethod:{},curProjects:[],nextProjectCounter:0,curPrizeIndex:-1,rebateGapList:[],todayDrawList:[],curServerTime:'',curRemainTime:0,remainTimer:{},curWaitOpenTime:0,waitOpenTimer:{},getLastOpenTime:0,getLastOpenTimer:{},canBuy:!1,traceMethodPrize:0,tracePrizeLimit:0,canTraceIssues:[],counters:0},settings),helper={SXBD:{0:1,1:1,2:2,3:3,4:4,5:5,6:7,7:8,8:10,9:12,10:13,11:14,12:15,13:15,14:15,15:15,16:14,17:13,18:12,19:10,20:8,21:7,22:5,23:4,24:3,25:2,26:1,27:1},EXBD:{0:1,1:1,2:2,3:2,4:3,5:3,6:4,7:4,8:5,9:5,10:5,11:4,12:4,13:3,14:3,15:2,16:2,17:1,18:1},SXHZ:{0:1,1:3,2:6,3:10,4:15,5:21,6:28,7:36,8:45,9:55,10:63,11:69,12:73,13:75,14:75,15:73,16:69,17:63,18:55,19:45,20:36,21:28,22:21,23:15,24:10,25:6,26:3,27:1},EXHZ:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,10:9,11:8,12:7,13:6,14:5,15:4,16:3,17:2,18:1},SXZXHZ:{1:1,2:2,3:2,4:4,5:5,6:6,7:8,8:10,9:11,10:13,11:14,12:14,13:15,14:15,15:14,16:14,17:13,18:11,19:10,20:8,21:6,22:5,23:4,24:2,25:2,26:1},pokerNumMaps:{A:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,T:10,J:11,Q:12,K:13},factorial:function(e){return e<=1?1:e*helper.factorial(e-1)},getNumByIssue:function(e){if(0==e.length)return!1;var t=e.indexOf("-");return-1!=t?e.substr(t+1):e.substr(e.length-3)},expandLotto:function(e){var t=[],a=[],n=0;if($.each(e,function(e,t){if(""!=$.trim(t)){var s=t.split("_");s.sort(),a.push(s)}else n=1}),n)return[];var s,r,l,i,o;switch(e.length){case 2:for(s=0;s<a[0].length;s++)for(r=0;r<a[1].length;r++)t.push(a[0][s]+" "+a[1][r]);break;case 3:for(s=0;s<a[0].length;s++)for(r=0;r<a[1].length;r++)for(l=0;l<a[2].length;l++)t.push(a[0][s]+" "+a[1][r]+" "+a[2][l]);break;case 5:for(s=0;s<a[0].length;s++)for(r=0;r<a[1].length;r++)for(l=0;l<a[2].length;l++)for(i=0;i<a[3].length;i++)for(o=0;o<a[4].length;o++)t.push(a[0][s]+" "+a[1][r]+" "+a[2][l]+" "+a[2][i]+" "+a[2][o]);break;default:throw"unkown expand"}var c=[];return $.each(t,function(e,t){var a=t.split(" ");array_unique(a).length==a.length&&c.push(t)}),c}},tool={uniqueArr:function(e){var t={};len=e.length,result=[];for(var a=0;a<len;a++)t[e[a]]||(t[e[a]]=!0,result.push(e[a]));return result}},initModesBar=function(){var e=.5,t=parseFloat(getCookie("mod_"+ps.lotteryId));$.each([.5],function(a,n){n==t&&(e=n)}),ps.curMode=e},modesBar={modesBtn_Click:function(){var e=$("#modesDIV").val();$('#projectList').children('li').length>0?parent.layer.confirm('切换元角分模式将影响您现有投注项，是否继续？',{icon:7},function(t){ps.curMode=e,buyBar.updateTotalSingle(),0!=$('#betCount').text()&&buyBar.updateSingle($('#betCount').text()),modesBar.saveLastModes(),prizeBar.showPirze(),parent.layer.close(t)},function(e){ps.curMode,$("#modesDIV").val(ps.curMode)}):(ps.curMode=e,0!=$('#betCount').text()&&buyBar.updateSingle($('#betCount').text()),modesBar.saveLastModes(),prizeBar.showPirze())},saveLastModes:function(){setCookie('mod_'+ps.lotteryId,ps.curMode,2592e3)}},initPrizeBar=function(){ps.rebateGapList=prizeBar.generateGapList(),0==ps.rebateGapList.length&&ps.halt("initPrizeBar failed"),ps.curPrizeIndex=ps.rebateGapList.length-1,prizeBar.showPirze(),$('#curPrizeSpan').change(prizeBar.changePrize)},prizeBar={changePrize:function(){if(!0!==$.isEmptyObject(ps.curMethod)&&ps.curMethod.description.indexOf("@P@")>0){for(var e=$("#curPrizeSpan option:selected").text().split("/"),t='',a=ps.curMethod.description.split("@P@"),n=1;n<a.length;n++)void 0!=ps.curMethod.prize[n]&&(t+=a[n-1]+Math.round(ps.curMethod.prize[n]*e[0]/ps.curMethod.prize[1]*1e4)/1e4+"元");t+=a[a.length-1],$("#methodDesc").text(t)}ps.curPrizeIndex=$("#curPrizeSpan").val(),prizeBar.saveLastPrize(),buyBar.updateTotalSingle()},generateGapList:function(){var e=[];$.each(ps.minRebateGaps,function(t,a){if(a.from=parseFloat(a.from),a.to=parseFloat(a.to),a.gap=parseFloat(a.gap),ps.rebate>a.to)for(var n=a.from;n<=a.to;n+=a.gap)e.push(parseFloat(number_format(n,3)));else{for(n=a.from;n<a.to&&n<ps.rebate;n+=a.gap)e.push(parseFloat(number_format(n,3)));e.push(parseFloat(number_format(ps.rebate,3)))}}),e=array_unique(e);var t=[];return $.each(e,function(e,a){var n=round(ps.maxCombPrize*(ps.prizeRate+a),0);t.push({rebate:round(ps.rebate-a,3),prize:n})}),t},showPirze:function(){if(!0!==$.isEmptyObject(ps.curMethod)){$('#curPrizeSpan').empty(),$.each(ps.rebateGapList,function(e,t){var a=round(ps.curMode*ps.curMethod.prize[1]*(ps.prizeRate+ps.rebate-ps.rebateGapList[e].rebate)/ps.prizeRate,4),n=round(ps.curMode*ps.curMethod.prize[2]*(ps.prizeRate+ps.rebate-ps.rebateGapList[e].rebate)/ps.prizeRate,4),s=number_format(100*parseFloat(ps.rebateGapList[e].rebate),1);"TMZX"==ps.curMethod.name||"SZS"==ps.curMethod.name||"EZE"==ps.curMethod.name||"ZTYM"==ps.curMethod.name?$('#curPrizeSpan').append('<option value="'+e+'"><a>'+a+'</a>/'+s+'%</option>'):$('#curPrizeSpan').append('<option value="'+e+'">一等奖:'+a+';二等奖:'+n+'/'+s+'%</option>'),$('#curPrizeSpan').siblings('span').html('奖金/返点')}),$("#curPrizeSpan").val(ps.curPrizeIndex),prizeBar.changePrize();var e=$('#curPrizeSpan option:selected').html();$('#rebateValue').html($('#curPrizeSpan option:selected').html().split('/')[1]),$('.rebateValue_lmlx').html($('#curPrizeSpan option:selected').html().split('/')[0].replace('一等奖:','').replace('二等奖:','').replace(';','/')),$('.rebateValue1').attr('placeholder',e.split('/')[0]),$('.rebateValue2').attr('placeholder',e.replace("一等奖:",'').split(';')[0]),$('.rebateValue3').attr('placeholder',e.split('/')[0].split(':')[2])}},saveLastPrize:function(){setCookie("reb_"+ps.lotteryId,ps.rebateGapList[ps.curPrizeIndex].rebate,2592e3)}},initMethodBar=function(){$.each(ps.methods,function(e,t){1==t.childs.length?$('<li class="methodGroupLI" id="methodGroup_'+e+'"><label>'+t.mg_name+"</label></li>").click(methodBar.methodGroup_Click).appendTo("#methodGroupContainer"):$('<li class="methodGroupLI" id="methodGroup_'+e+'"><label>'+t.mg_name+"</label></li>").click(methodBar.methodGroup_Click).hover(methodBar.methodGroup_hoverOver,methodBar.methodGroup_hoverOut).appendTo("#methodGroupContainer");var a='',n='',s='',r='',l='',i='',o='',c='',u='',p='',d='';6==t.mg_id||50==t.mg_id||57==t.mg_id||169==t.mg_id?(p='<dl class="fix"><dt>任选复式：</dt>',d='<dl class="fix"><dt>任选单式：</dt>'):(a='<dl class="fix"><dt>直选：</dt>',n='<dl class="fix"><dt>组选：</dt>',s='<dl class="fix"><dt>趣味：</dt>',r='<dl class="fix"><dt>特殊：</dt>',l='<dl class="fix"><dt>定位：</dt>',i='<dl class="fix"><dt>不定位：</dt>',o='<dl class="fix"><dt>任选二：</dt>',c='<dl class="fix"><dt>任选三：</dt>',u='<dl class="fix"><dt>任选四：</dt>',p='<dl class="fix"><dt>其他：</dt>');var h=$('<div id="method_'+e+'"></div>').addClass('methodPopStyle').hide();$.each(t.childs,function(h,m){var f='<dd class="method" name="'+m.name+'" id="method_'+e+"_"+h+'">'+m.cname+'</dd>',y='';1==m.method_property?a+=f:2==m.method_property?n+=f:3==m.method_property?s+=f:4==m.method_property?r+=f:5==m.method_property?l+=f:6==m.method_property?i+=f:7==m.method_property?o+=f:8==m.method_property?c+=f:9==m.method_property?u+=f:0==m.method_property&&(p+=f),1==m.can_input&&(y='<dd class="method" name="'+m.name+"son\" id=\"method_"+e+"_"+h+"son\">"+m.cname+"单式</dd>",1==m.method_property?a+=y:2==m.method_property?n+=y:3==m.method_property?s+=y:4==m.method_property?r+=y:5==m.method_property?l+=y:6==m.method_property?i+=y:7==m.method_property?o+=y:8==m.method_property?c+=y:9==m.method_property?u+=y:0==m.method_property&&(6==t.mg_id||50==t.mg_id||57==t.mg_id||169==t.mg_id?d+=y:p+=y))}),n+='</dl>',s+='</dl>',r+='</dl>',l+='</dl>',i+='</dl>',o+='</dl>',c+='</dl>',u+='</dl>',p+='</dl>',d+='</dl>',(a+='</dl>').indexOf('</dd>')<0&&(a=''),n.indexOf('</dd>')<0&&(n=''),s.indexOf('</dd>')<0&&(s=''),r.indexOf('</dd>')<0&&(r=''),l.indexOf('</dd>')<0&&(l=''),i.indexOf('</dd>')<0&&(i=''),o.indexOf('</dd>')<0&&(o=''),c.indexOf('</dd>')<0&&(c=''),u.indexOf('</dd>')<0&&(u=''),p.indexOf('</dd>')<0&&(p=''),d.indexOf('</dd>')<0&&(d=''),$(a+n+s+r+l+i+o+c+u+p+d).appendTo(h),$.each(t.childs,function(t,a){$('#method_'+e+"_"+t).live("click",a,methodBar.method_Click).hover(methodBar.method_hoverOver,methodBar.methodGroup_hoverOut),$("#method_"+e+"_"+t+"son").live("click",a,buyBar.inputBtn_Click).hover(methodBar.method_hoverOver,methodBar.methodGroup_hoverOut)}),$("#methodGroup_"+e).append(h)}),$(".subTopBar").mouseleave(function(){$(this).find("li").removeClass("methodGroup_hover"),$(this).find("ul li .methodPopStyle").hide()}),methodBar.selectDefault()},methodBar={methodGroup_Click:function(e){$(this).addClass("methodGroup_selected").siblings().removeClass("methodGroup_selected methodGroup_hover"),$(e.target).is('label')&&($("#traceBtn").show(),$(".choMainTab").children('.progressBar')&&($(".progressBar").remove(),$(".choMainTab").css("padding-top",""))),$(this).addClass("methodGroup_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1;$(".playNav ul .methodPopStyle").hide(),$(this).find('.methodPopStyle').show()},methodGroup_hoverOver:function(){$(this).addClass("methodGroup_hover"),$(this).hasClass("methodGroup_selected")&&$(this).find('.methodPopStyle').show()},methodGroup_hoverOut:function(){$(this).removeClass("methodGroup_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1},method_hoverOver:function(){$(this).addClass("method_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1;$(this).find('.methodPopStyle').show()},method_hoverOut:function(){$(this).removeClass("method_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1;$(this).find('.methodPopStyle').hide()},method_Click:function(e){return ps.curMethod=e.data,$('.methodPopStyle').hide(),$('#methodGroupContainer').find('.method').removeClass("method_selected"),$(this).addClass("method_selected"),$(".GameText span").text($(this).text()),$('#curMethod').text(ps.curMethod.cname),$("#methodDesc").html(ps.curMethod.description).hide(),$("#methodTipInfo").click(function(){layer.tips($("#methodDesc").html(),this,{tips:[2,'#f13131'],time:0,closeBtn:0,shade:[.1,'#000'],shadeClose:!0})}),ballBar.generateBall(),$(".selectRandomBtn").parent().hide(),buyBar.updateSingle(0),prizeBar.showPirze(),0==propLen(ps.curMethod.field_def)&&(ballBar.showInput(),$("#singleInfo").show(),$("#selectArea").removeClass("N-selected")),2==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","10px 0"),3==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","10px 0"),4==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","5px 0"),!1},selectDefault:function(){$("#methodGroupContainer").find("label:contains('特码')").click(),$(".playNav ul ul").hide()}},ballBar={reset:function(){$.isEmptyObject(ps.curMethod.field_def)||($.each(ps.curMethod.field_def,function(e,t){}),buyBar.updateSingle(0))},showInput:function(){$("#selectArea").children().remove(),$(str).appendTo("#selectArea"),$("#delTA").click(function(){$("#inputTA").val(""),$(".FatherCodeBtn").removeClass("selectCodeBtn_selected")}),$("#inputTA").live('keyup',function(){''!=$("#inputTA").val()?($(".FatherCodeBtn").addClass('selectCodeBtn_selected'),$(this).removeClass('MachineSeleBg')):($(".FatherCodeBtn").removeClass('selectCodeBtn_selected'),$(this).addClass('MachineSeleBg'))})},generateBall:function(){$("#selectArea").children().remove();var e=new Array(1,2,7,8,12,13,18,19,23,24,29,30,34,35,40,45,46),t=new Array(3,4,9,10,14,15,20,25,26,31,36,37,41,42,47,48),a=new Array(5,6,11,16,17,21,22,27,28,32,33,38,39,43,44,49);$.each(ps.curMethod.field_def,function(n,s){var r=s.nums.split(" "),l='',i="";$.each(r,function(n,s){switch(ps.curMethod.name){case"SXBD":case"ZSBD":case"QSBD":l+='<li>'+s+'</li>',i+='<li>'+helper.SXBD[n]+'</li>';break;case"SXHZ":case"ZSHZ":case"QSHZ":l+='<li>'+s+'</li>',i+='<li>'+helper.SXHZ[n]+'</li>';break;case"EXBD":case"QEBD":l+='<li>'+s+'</li>',i+='<li>'+helper.EXBD[n]+'</li>';break;case"EXHZ":case"QEHZ":l+='<li>'+s+'</li>',i+='<li>'+helper.EXHZ[n]+'</li>';break;case'SXZXHZ':case'QSZXHZ':l+='<li>'+s+'</li>',i+='<li>'+helper.SXZXHZ[n+1]+'</li>';break;case'TMZX':case'ZTYM':var r='';-1!=$.inArray(parseInt(s),e)?r='bg_red':-1!=$.inArray(parseInt(s),t)?r='bg_blue':-1!=$.inArray(parseInt(s),a)&&(r='bg_green');l+='<li class="'+r+'">'+s+'</li>';break;case'ELX':case'SLX':case'SILX':case'SZS':case'SZE':case'EZE':l+='<li>'+s+'</li>';break;default:var o='';'蓝'==s?o='blue':'红'==s?o='red':'绿'==s&&(o='green');var c='rebateValue2';s>0&&(c='rebateValue3'),'鸡'==s&&(c='rebateValue3'),'红'==s&&(c='rebateValue3'),'大'==s&&(c='rebateValue3'),'单'==s&&(c='rebateValue3'),l+='<li class="'+o+'">'+s+'<div class="lhc_sx"><input  class="'+c+'" disabled="disabled" placeholder=""/></div></li>'}});l="ELX"===ps.curMethod.name||"SLX"===ps.curMethod.name||"SILX"===ps.curMethod.name||"SZS"===ps.curMethod.name||"SZE"===ps.curMethod.name||"EZE"===ps.curMethod.name?"<li><ul class=\"ballList"+(/(BD|HZ)$/.test(ps.curMethod.name)?" w400":"")+'" id=field_'+n+">"+l+"</ul></li>":"<li><ul class=\"ballList"+(/(BD|HZ)$/.test(ps.curMethod.name)?" w400":"")+' dice" id=field_'+n+">"+l+"</ul></li>",-1!==$.inArray(ps.curMethod.name,['ZTYX','ZTWS','TMWS','TMSX','TMSX','TMSB','TMDXDS'])?$(".hz_lmlx").hide():$(".hz_lmlx").show(),i='<li><ul class="BDHZinfo">'+i+"</ul></li>";var o="";/(DXDS)$/.test(ps.curMethod.name)?o=' DXDS-margin-left ':/(SDDDS)$/.test(ps.curMethod.name)?o=' SDDDS-margin-left':/(SDCZW)$/.test(ps.curMethod.name)&&(o=' SDCZW-margin-left'),$('<div class="locate" id="locate_'+n+'"><ul class="lotteryNumber'+o+'">'+(s.prompt?'<li class="areaPrefix">'+s.prompt+"</li>":"")+l+"</ul></div>").appendTo("#selectArea"),s.has_filter_btn&&($("#locate_"+n).find("ul .areaPrefix").after("<li class=\"Quick\"><div class=\"QuickChoose\"><dl class=\"navSub\"><dd>全</dd><dd>奇</dd><dd>偶</dd> <dd>大</dd><dd>小</dd><dd>清</dd></dl></div></li>"),$("#locate_"+n).find("dd").click(function(){switch($(this).addClass("DDcolor").siblings().removeClass("DDcolor"),$(this).text()){case'全':$('#field_'+n).children().addClass('ball_Selected');break;case'奇':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+n).children().removeClass('ball_Selected').parent().find(":odd").addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+n).children().removeClass('ball_Selected').parent().find(":even").addClass('ball_Selected');break;case'偶':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+n).children().removeClass('ball_Selected').parent().find(":even").addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+n).children().removeClass('ball_Selected').parent().find(":odd").addClass('ball_Selected');break;case'大':$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return e>=5}).addClass('ball_Selected');break;case'小':$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return e<5}).addClass('ball_Selected');break;case'清':$('#field_'+n).children().removeClass('ball_Selected');break;case'质':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return-1!=$.inArray(e,[2,3,5,7])}).addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return-1!=$.inArray(e,[1,2,4,6,10])}).addClass('ball_Selected');break;case'合':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return-1!=$.inArray(e,[4,6,8,9])}).addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+n).children().removeClass('ball_Selected').filter(function(e){return-1!=$.inArray(e,[3,5,7,8,9])}).addClass('ball_Selected')}ballBar.computeSingle()}));var c=[];c.length>0&&$.each(c,function(e,t){$(t).appendTo('#selectArea')})}),$('.lotteryNumber ul>li').bind("click",ballBar.ball_Click),$(".multiple1").click(function(){this.focus(),this.select()}).blur(function(){''!=this.value&&0!=this.value||(this.value='',buyBar.updateTotalSingle())}).keyup(buyBar.checkMultiple).keyup(buyBar.updateTotalSingle)},getAssisInfo:function(e){var t="",a=[];if(!$.isArray(ps.missHot.miss)||!$.isArray(ps.missHot.hot))return[];var n=-1;switch(ps.curMethod.name){case"QSZX":case"QSLX":case"QEZX":case"QELX":case"QSIZX":case"WXZX":case"WXLX":case"WXDW":case'SXDW':case"SDQSZX":case"SDQEZX":n=e-1+0;break;case"SIXZX":case"ZSZX":case"ZSLX":n=e-1+1;break;case"SXZX":case"SXLX":n=e-1+2;break;case"EXZX":case"EXLX":n=e-1+3;break;case"YXZX":n=e-1+4}return n>-1&&($.each(ps.missHot.miss[n],function(e,a){t+='<li class="yiLouNum">'+a+"</li>"}),t='<div class="missDIV" id="missHot_'+e+'"><ul class="missHotNumber"><li class="missHotUnit">遗漏:</li><li><ul class="yiLouList" id=yiLouList_'+e+">"+t+"</ul></li></ul></div>",a.push(t),t="",$.each(ps.missHot.hot[n],function(e,a){t+='<li class="yiLouNum">'+a+'</li>'}),t='<div class="hotDIV" id="missHot_'+e+'"><ul class="missHotNumber"><li class="missHotUnit">冷热:</li><li><ul class="yiLouList" id=yiLouList_'+e+">"+t+"</ul></li></ul></div>",a.push(t)),a},ball_Click:function(e){$(this).toggleClass("ball_Selected"),/\w+_(\d+)/.test($(this).parent().attr("id"));var t=RegExp.$1;$(this).parent().find(".ball_Selected").length>ps.curMethod.field_def[t].max_selected?1==ps.curMethod.field_def[t].max_selected?$(this).siblings(".ball_Selected").removeClass("ball_Selected"):($(this).removeClass("ball_Selected"),parent.layer.alert("当前最多只能选择"+ps.curMethod.field_def[t].max_selected+"个号码",{icon:7})):('JSETDX'==ps.curMethod.name&&$('#locate_'+(1==t?2:1)).find(".ballList_k3no_square li").eq(parseInt($(this).text().substr(0,1))-1).removeClass("ball_Selected"),ballBar.computeSingle())},computeSingle:function(){var e=[];$.each(ps.curMethod.field_def,function(t,a){var n="",s=ps.curMethod.field_def[t].nums.split(" ");$("#field_"+t+" li").each(function(e){$(this).hasClass("ball_Selected")&&(9==ps.lotteryType||ps.curMethod.field_def[t].max_selected>10||s[s.length-1].length>1?n+=$(this).text()+"_":n+=$(this).text())}),-1==n.indexOf("_")?e.push(n):e.push(n.substr(0,n.length-1))});var t=isLegalCode(e);buyBar.updateSingle(t.singleNum),'WXDW'!=ps.curMethod.name&&'REZX'!=ps.curMethod.name&&'RSZX'!=ps.curMethod.name&&'RSIZX'!=ps.curMethod.name||$.each(e,function(t,a){''==a&&(e[t]='-')});var a=e.join(",");return'JSSTTX'==ps.curMethod.name?a='111_222_333_444_555_666':'JSSLTX'==ps.curMethod.name&&(a='123_234_345_456'),{singleNum:t.singleNum,isDup:t.isDup,code:a}}},initMissHotBar=function(){$("input[name=missHotBtn]").click(missHotBar.missHotBtn_Click),$('input[name=missHotBtn][value="1"]').click()},missHotBar={missHotBtn_Click:function(){"1"==$(this).val()?($("#selectArea .missDIV").removeClass("hidden"),$("#selectArea .hotDIV").addClass("hidden")):($("#selectArea .missDIV").addClass("hidden"),$("#selectArea .hotDIV").removeClass("hidden"))}},initBuyBar=function(){ps.nextProjectCounter=0,buyBar.removeAll(),$("#multiple").click(function(){this.focus(),this.select()}).blur(function(){''!=this.value&&0!=this.value||(this.value=1,buyBar.updateTotalSingle())}).keyup(buyBar.checkMultiple).keyup(buyBar.updateTotalSingle),$(".inputNumJian").click(function(){var e=$("#multiple").val();1==e?$("#multiple").val(parseInt(1)):$("#multiple").val(parseInt(e)-1),buyBar.updateTotalSingle()}),$(".inputNumJia").click(function(){var e=$("#multiple").val();e>5e3?$("#multiple").val(parseInt(5e3)):$("#multiple").val(parseInt(e)+1),buyBar.updateTotalSingle()}),$(".xDel").live("click",function(){$(this).parent().remove(),buyBar.updateTotalSingle()}),$("#clearProjectBtn").click(buyBar.removeAll),$("#inputBtn").click(buyBar.inputBtn_Click),$("#selectCodeBtn").click(buyBar.selectCodeBtn_Click),$("#selectCodeBtnFast").click(buyBar.selectCodeBtnFast),$("#confirmBtn").click(function(){buyBar.confirmBtn_Click()}),$("#confirmBtn_g").click(function(){buyBar.confirmBtn_Click_g(0)}),$(".selectRandomBtn").click(buyBar.selectRandomBtn_Click)},buyBar={selectCodeBtnFast:function(){buyBar.selectCodeBtn_Click(),buyBar.confirmBtn_Click(1)},inputBtn_Click:function(e){ps.curMethod=e.data,$('.methodPopStyle').hide(),ballBar.showInput(),$('#methodGroupContainer').find('.method').removeClass("method_selected"),$(this).addClass("method_selected"),$("#selectCodeBtn").addClass("selectCodeBtn_selected"),$(".selectRandomBtn").parent().show(),$("#selectArea").removeClass("N-selected")},selectCodeBtn_Click:function(){if(0==$("#totalBetCount").text()&&parent.layer.alert("请先选择号码再投注",{icon:7}),$("#inputTA").length>0){var e=[];if(0==$.trim($("#inputTA").val()).length)return!1;var t={singleNum:1,isDup:0},a='<li><span class="width1" mid="'+ps.curMethod.method_id+'" mname="'+ps.curMethod.name+'">',n=ps.curMethod.cname+'</span><span class="width2">';if(e.length<=1e3)for(var s in e){var t=isLegalCode(e[s]),r=number_format(2*t.singleNum*ps.curMode,3),l='</span><span class="width3">'+t.singleNum+'注</span><span class="width4">￥'+r+'</span><span class="xDel">X</span></li>';if(t.isDup)return parent.layer.alert("您输入的号码有误，请重新检查输入!",{icon:7}),!1;ps.nextProjectCounter++,$(a+n+e[s].join(",")+l).appendTo("#projectList")}else{var i='',o='';for(var s in e)if(i&&(i+='|'),i+=e[s].join(","),(t=isLegalCode(e[s])).isDup)return parent.layer.alert("您输入的号码有误，请重新检查输入!",{icon:7}),!1;var r=number_format(2*e.length*ps.curMode,3),l='</span><span class="width3">'+e.length+'注</span><span class="width4">￥'+r+'</span><span class="xDel">X</span></li>';ps.nextProjectCounter=e.length,$(o+=a+n+i+l).appendTo("#projectList")}buyBar.updateTotalSingle(),$("#delTA").click()}else{if(0==(t=ballBar.computeSingle()).singleNum)return!1;ps.nextProjectCounter++;r=number_format(2*t.singleNum*ps.curMode,3);$('<li><span class="width1" mid="'+ps.curMethod.method_id+'" mname="'+ps.curMethod.name+'">'+ps.curMethod.cname+'</span><span class="width2">'+t.code+'</span><span class="width3">'+t.singleNum+'注</span><span class="width4">￥'+r+'</span><span class="xDel">X</span></li>').appendTo("#projectList"),buyBar.updateTotalSingle(),ballBar.reset()}$(".locate dd").removeClass("DDcolor"),$("#confirmBtn_g").click()},rxInputCodes:function(e,t){for(var a=['-','-','-','-','-'],n=e[0];n<=e[e.length-1];n++)a[n]=''},removeAll:function(){$(".ballList li").removeClass('ball_Selected'),$(".form-control").val(""),$("#selectCodeBtn").removeClass('selectCodeBtn_selected'),$("#betCount").text('0'),$("#token").val(""),$("#projectList").empty(),ps.nextProjectCounter=0,$("#multiple").val("10"),buyBar.updateTotalSingle()},updateSingle:function(e){var t=number_format(2*e*ps.curMode,3);$("#betCount").text(e),$("#betAmount").text(t);var a=0==$('#projectList li').length?1:$('#projectList li').length;e>0?$("#selectCodeBtn").addClass('selectCodeBtn_selected'):($("#selectCodeBtn").parent().removeClass('selectCodeBtn_selected'),$("#selectCodeBtn").removeClass('selectCodeBtn_selected'));var n,s=$("#totalBetAmount").text(),r=$('#curPrizeSpan').find("option:selected").text();n="特码直选"==ps.curMethod.cname||"三中三"==ps.curMethod.cname||"二中二"==ps.curMethod.cname||"正特一码"==ps.curMethod.cname?r.split('/')[0]:null===(n=r.match(/\d+\.\d+/))||0===n.length||0==+n[0]?r.match(/\d+/)[0]:n[0],e>0?$("#totalWin").text(number_format(n*a*$("#multiple").val()-s-t,3)):$("#totalWin").text(number_format(n*a*$("#multiple").val()-s,3))},updateTotalSingle:function(){var e=0;$("#projectList").children("li").each(function(t){var a=$(this).children();e+=parseInt(a.eq(2).text()),a.eq(3).text("￥"+number_format(2*parseInt(a.eq(2).text())*$("#multiple").val()*ps.curMode,3))}),e>0?$("#confirmBtn").addClass('CantapCodeBtn_selected'):$("#confirmBtn").removeClass('CantapCodeBtn_selected');0==$('#projectList li').length||$('#projectList li').length;$("#totalBetCount").text(e);var t=number_format(2*e*$("#multiple").val()*ps.curMode,3);return $("#totalBetAmount").text(t),!0},checkMultiple:function(){return this.value=this.value.replace(/^0|[^\d]/g,''),!($(this).val()>5e4)||(parent.layer.alert("请重新输入金额,单注最高额度为50000",{icon:7}),$(this).val(5e4),!0)},confirmBtn_Click_g:function(e){var t={},a='';if($("#projectList").children("li").each(function(e){t[$(this).children().eq(0).attr("mid")]||(t[$(this).children().eq(0).attr("mid")]={}),t[$(this).children().eq(0).attr("mid")][e]=$(this).children().eq(1).text()}),$.each(t,function(e,t){a+=e+':',$.each(t,function(e,t){a+=t+'|'}),a=rtrim(a,'|'),a+='#'}),a=rtrim(a,'#'),!ps.canBuy)return parent.layer.alert("该期已截止购买",{icon:7}),!1;if(0==a.length)return parent.layer.alert("请先选择号码再投注",{icon:7}),!1;$("#token").val(getRandChar(32));var n=$("#totalBetAmount").text(),s=$("#totalBetCount").text(),r=$("#multiple").val();if(0==n||0==s)return parent.layer.alert("请选填写整数金额，例如：100",{icon:7}),$("#projectList").empty(),!1;var l=0;if(0==e){1==ps.curMode||(.5==ps.curMode||(.1==ps.curMode||(.05==ps.curMode||ps.curMode)));var i='';i=a.split(':')[1];var o='<div id="buy_message">请确认以下投注内容：<br>************************<br>玩法：<span>'+ps.curMethod.cname+'</span><br>期号：'+ps.curIssueInfo.issue+'<br>内容：'+i+'<br>注数：'+s+"注<br>投注总额：￥"+n+"<br>************************<br></div>";parent.layer.confirm(o,{icon:7},function(e){if(parent.$('.xubox_botton').empty(),parent.$('.xubox_botton').html('<div class="LoadingShow"><span class="Loading_icon"></span><span class="Loading_Font">投注中，请稍后...</span></div>'),1==(l+=1)){$.post("?c=game&a=play",{op:"buy",lotteryId:ps.lotteryId,issue:ps.curIssueInfo.issue,curRebate:ps.rebateGapList[ps.curPrizeIndex].rebate,modes:ps.curMode,codes:a,xgame:1,multiple:$("#multiple").val(),token:$("#token").val()},function(t){if(0==t.errno){drawBar.todayBuyBtnNew_Click(),buyBar.removeAll();var a='<div id="buy_success_message">购买成功!<br>************************<br>订单编号：'+t.pkgnum+"<br>玩法：<span>"+ps.curMethod.cname+'</span><br>期号：'+ps.curIssueInfo.issue+'<br>内容：'+i+'<br>注数：'+s+"注<br>投注总额：￥"+n+"<br>************************<br></div>";parent.layer.close(e),parent.layer.alert(a,{icon:1}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")})}else 65534==t.errno||(parent.layer.close(e),console.log("错误代码:"+t.errno),parent.layer.alert("购买失败:"+t.errstr,{icon:2}));showBalance()},"json").fail(function(t){parent.layer.close(e),parent.layer.alert("网络异常，请在“游戏记录-订单查询”中确认该订单是否提交成功。",{icon:2})});var t=setInterval(function(){0==(l=0)&&clearInterval(t)},5e3)}});$("#projectList").empty(),$("#totalBetCount").text("0")}else parent.$('.xubox_botton').empty(),parent.$('.xubox_botton').html('<div class="LoadingShow"><span class="Loading_icon"></span><span class="Loading_Font">投注中，请稍后...</span></div>'),$.post("?c=game&a=play",{op:"buy",lotteryId:ps.lotteryId,issue:ps.curIssueInfo.issue,curRebate:ps.rebateGapList[ps.curPrizeIndex].rebate,modes:ps.curMode,codes:a,xgame:1,multiple:$("#multiple").val(),token:$("#token").val()},function(e){if(0==e.errno){drawBar.todayBuyBtnNew_Click(),buyBar.removeAll();var t='<div id="buy_success_message">购买成功!<br>************************<br>订单编号：'+e.pkgnum+"<br>投注期号："+ps.curIssueInfo.issue+"<br>投注总额：￥"+n+"<br>模&nbsp;&nbsp;式："+(1==ps.curMode?"2元":.5==ps.curMode?"1元":.1==ps.curMode?"2角":.05==ps.curMode?"1角":.01==ps.curMode?"分":"厘")+"模式<br>倍&nbsp;&nbsp;数："+r+"倍<br>************************<br></div>";parent.layer.alert(t,{icon:1}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")})}else 65534==e.errno||(console.log("错误代码:"+e.errno),parent.layer.alert("购买失败:"+e.errstr,{icon:2}));showBalance()},"json").fail(function(e){parent.layer.alert("网络异常，请在“游戏记录-订单查询”中确认该订单是否提交成功。",{icon:2})});parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")})},traceBtn_Click:function(){if(0==$("#projectList li").length)return parent.layer.alert("请先选择投注号码",{icon:7}),!1;var e=[];$("#projectList li").each(function(t){-1==$.inArray($(this).find("span:first").attr("mid"),e)&&e.push($(this).find("span:first").attr("mid"))}),$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getTracePage",lotteryId:ps.lotteryId,mids:e.join(",")},cache:!1,dataType:"json",timeout:3e4,success:function(t){if($("#traceBtn").removeAttr("disabled"),0==t.errno){ps.canTraceIssues=t.issues,ps.traceMethodPrize=t.prize,ps.tracePrizeLimit=t.prizeLimit;var a=traceFunc.showTracePage("<div id=\"traceHtml\"><div class=\"beitouToolsBox\"><ul class=\"beitouToolsQishi\"><li class=\"beitouToolsQishiR\"><span class=\"SpanPlace\">倍数:</span><div class=\"inputNum select-area\"><input type=\"text\" id=\"style1BodyMultiple\" class=\"zhuiz_number_e2 select-value\" value=\"1\" size=\"5\"  maxlength=\"5\" /><select class=\"multipleNumValue hand\"><option>1</option><option>5</option><option>10</option><option>20</option></select></div><div  class=\"multipleNum\"><span class=\"SpanPlace\">追号期数：</span><div class=\"inputNum select-area\"><input type=\"text\" id=\"traceNum\" class=\"zhuiz_number_e2\" value=\"1\" size=\"5\"  maxlength=\"5\" /></div><select class=\"multipleNumValue hand\"><option>1</option><option>5</option><option>10</option><option>20</option></select><li class=\"beitouToolsQishiL\"><span>起始:</span><span><select id=\"startIssue\"></select></span></li><div class=\"beitouToolsfotter FloatRight\"><p><span style=\"font-weight:bold;\">中奖后停止</span><input  type=\"checkbox\" value=\"1\" name=\"stopOnWin\" checked=\"checked\" /></p></div></ul><div class=\"beitouToolsmainBox\"><div style=\"display:block;\" id=\"multipleStyle1DIV\"><ul class=\"beitouToolsmainBoxTop\" id=\"style1Head\"><li class=\"checkbox\"><input type=\"checkbox\" id=\"checkAll\" checked /></li><li>期号</li><li>倍数</li><li>当前投入</li><li>累计投入</li></ul><ul class=\"beitouToolsmainBoxCont\" id=\"style1Body\"></ul></div><div class=\"beitouToolSmainbt\" id=\"multipleStyle2DIV\" style=\"display:none;\"><p>起始倍数<input type=\"text\" value=\"1\" class=\"beitouToolsinput\" name=\"startMultiple\" id=\"startMultiple\" maxlength=\"5\" size=\"5\"/></p><ul class=\"beitouToolSmainbtzk\" id=\"beitouToolSmainbtzk\"><li><input type=\"radio\" name=\"profitStyle\"  value=\"1\" />                            全程利润率:<input type=\"text\" size=\"5\" value=\"10\" name=\"totalProfitRate\" class=\"beitouToolsinput\" class=\"beitouToolsinput\" />                            %</li><li><input type=\"radio\" name=\"profitStyle\"  value=\"2\"/>                            前<input type=\"text\" size=\"5\" value=\"5\" name=\"first5Rate\" class=\"beitouToolsinput\"/>                            期利润率<input type=\"text\" size=\"5\"  class=\"beitouToolsinput\" value=\"10\" name=\"first5RateValue\"/>                            %,之后利润率<input type=\"text\" size=\"5\" value=\"5\" class=\"beitouToolsinput\" name=\"laterRateValue\"/>                            %</li><li><input type=\"radio\" name=\"profitStyle\"  value=\"3\"/>                            全程累计利润:<input type=\"text\" size=\"5\" value=\"100\" name=\"totalProfit\" class=\"beitouToolsinput\" />                            元</li><li><input type=\"radio\" name=\"profitStyle\" value=\"4\"/>                            前<input type=\"text\" size=\"5\" value=\"5\" class=\"beitouToolsinput\" name=\"first5Profit\" />                            期累计利润<input type=\"text\" size=\"5\"  class=\"beitouToolsinput\" value=\"100\" name=\"first5ProfitValue\" />                            元,之后累计利润<input type=\"text\" size=\"5\" value=\"50\" class=\"beitouToolsinput\"  name=\"laterProfitValue\" />                            元</li></ul><span class=\"beitouTooltzjhb\"><input type=\"button\"  class=\"bt_tools_navys\" id=\"generalPlanBtn\" value=\"生成投资计划表\"/></span><ul class=\"beitouToolSmainbtContTop\" id=\"style2Head\"><li class=\"spanWidth90px\">期号</li><li class=\"spanWidth50px\">倍数</li><li class=\"spanWidth70px\">当前投入</li><li class=\"spanWidth70px\">累积投入</li><li class=\"spanWidth70px\">当期奖金</li><li class=\"spanWidth70px\">合计利润</li><li class=\"spanWidth70px\">利润率</li></ul><ul class=\"beitouToolSmainBTContZneir\" id=\"style2Body\"></ul></div></div><ul class=\"beitouToolsTop\"><li class=\"TextAlignC\"> 包含当前期最多追<span id=\"maxTraceCount\">0</span>期</li><li class=\"beitouToolsTopContent fix\"><ul><li class=\"beitouToolsTopCont1\">单倍注数<span id=\"singleNum\"></span>注,购买<span id=\"issuesNum2\"></span>期,<span class=\"FloatRight\">合计￥<span id=\"traceTotalAmount\"></span></span></li></ul><ul class=\"beitouToolsQs\"><li>期数倍数<span><input type=\"radio\" name=\"multipleStyle\" id=\"multipleStyle1\" value=\"1\" class=\"radio1\" /><label for=\"multipleStyle1\">自定义</label></span><span class=\"FloatRight\">                                当前期倒计时：<label id=\"remainTimerLabel\"></label></span></li></ul><ul><li class=\"beitouToolsButton\"><input class=\"btnOne\" id=\"confirmTraceBtn\" value=\"确认追号\"></input></li></ul></li><li class=\"beitouToolsTopR\"></li></ul></div>          "),n=[250,251,360,368,28,56,101,202,298,34,57,102,203,304,4,52,106,193,274,5,53,107,194,275,81,108,109,195,351,42,75,115,219,312,43,76,116,220,313,38,71,120,214,308,39,72,121,215,309,82,110,122,216,352,86,93,126,228,356,87,94,127,229,357,88,95,128,230,358,47,78,141,222,317,235,236,386,25,155,173,189,24,154,172,188];0!=t.prize&&1==e.length&&-1==$.inArray(parseInt(ps.curMethod.method_id),n)||$("#multipleStyle2",parent.document).attr("disabled",!0),$("input[name=multipleStyle]",parent.document).click(traceFunc.multipleStyle_Click),$("#confirmTraceBtn",parent.document).click(function(){traceFunc.confirmTraceBtn_Click()&&parent.layer.close(a)}),$("#cancelTraceBtn",parent.document).click(function(){traceFunc.cancelTraceBtn_Click(),parent.layer.close(a)}),$("#startIssue",parent.document).change(traceFunc.startIssue_Change),$("#traceNum",parent.document).click(function(){this.focus(),this.select()}).keyup(buyBar.checkMultiple).keyup(traceFunc.traceNum_Keyup),$(".multipleNumDropdown",parent.document).mousemove(function(){$(this).addClass('multipleNumDropdownSelected')}).mouseout(function(){$(this).removeClass('multipleNumDropdownSelected')}).click(function(){'none'==$(this).next('.multipleNumValue').css('display')?$(this).next('.multipleNumValue').slideDown('fast'):$(this).next('.multipleNumValue').slideUp('fast')}),$(".multipleNumValue li",parent.document).mousemove(function(){$(this).addClass('multipleNumValueSelected')}).mouseout(function(){$(this).removeClass('multipleNumValueSelected')}).click(function(){var e=$(this).parent().siblings('.zhuiz_number_e2');e.val(parseInt($(this).text())),$.proxy(buyBar.checkMultiple,e.get(0))(),'style1BodyMultiple'==e.attr('id')?($('.style1BodyMultiple',parent.document).val(e.val()).each(function(){$.proxy(traceFunc.style1BodyMultiple_Keyup,$(this).get(0))()}),traceFunc.updateTotalMoney()):'traceNum'==e.attr('id')&&$.proxy(traceFunc.traceNum_Keyup,e.get(0))(),$(this).parent().slideUp('fast')}),$('#style1BodyMultiple',parent.document).click(function(){this.focus(),this.select()}).keyup(buyBar.checkMultiple).keyup(function(){isNaN(parseInt($(this).val()))?$('.style1BodyMultiple').val(1):($('.style1BodyMultiple',parent.document).val($(this).val()).each(function(){$.proxy(traceFunc.style1BodyMultiple_Keyup,$(this).get(0))()}),traceFunc.updateTotalMoney())}),$('#checkAll',parent.document).click(function(){$(this).is(':checked')?$('.checkbox input[type=checkbox]',parent.document).attr('checked',!0).parent().parent().css('color',''):$('.checkbox input[type=checkbox]',parent.document).attr('checked',!1).parent().parent().css('color','#ccc'),traceFunc.updateTotalMoney()}),$('.checkbox input[type=checkbox]',parent.document).live('click',function(){if('checkAll'!=$(this).attr('id')){$(this).is(':checked')?$(this).parent().parent().css('color',''):$(this).parent().parent().css('color','#ccc');var e=$(this).parent().parent().index();$.proxy(traceFunc.style1BodyMultiple_Keyup,$('#style1BodyMultiple_'+e,parent.document).get(0))(),traceFunc.updateTotalMoney()}}),$("#singleNum",parent.document).text($("#totalBetCount").text()),$("#issuesNum2",parent.document).text("1"),$("#multipleStyle1",parent.document).click(),traceFunc.updateTotalMoney(),runTime.traceRemainTimer=window.setInterval(traceFunc.traceRemain_Timer_Handle,1e3)}else alert("系统繁忙，请稍候再试(01)")},error:function(e,t,a){$("#traceBtn").removeAttr("disabled"),-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(alert("您已经退出，请重新登录"),window.location.href="?a=logout"):alert("操作超时，请刷新页面.")}})},selectRandom:function(){var e,t,a=propLen(ps.curMethod.field_def),n={},s=[];switch(ps.curMethod.name){case'WXDW':n.WXDW=1;case'REZX':n.REZX=2;case'RSZX':n.RSZX=3;for(o=0;o<a;o++)s[o]="-";for(var r=[],l=1;l<=n[ps.curMethod.name];l++){count=Math.floor(Math.random()*a+1);h=!1;for(var i in r)if(r[i]===count){h=!0;break}if(h)l--;else{r.push(count),e=parseInt(ps.curMethod.field_def[l].max_selected),t=Math.floor(Math.random()*e);f=(m=ps.curMethod.field_def[l].nums.split(" "))[t];s[count-1]=f}}break;case'RSIZX':n.RSIZX=4;for(var o=0;o<a;o++)s[o]="-";for(var r=[],l=1;l<=n[ps.curMethod.name];l++){count=Math.floor(Math.random()*a+1);h=!1;for(var i in r)if(r[i]===count){h=!0;break}if(h)l--;else{r.push(count),e=parseInt(ps.curMethod.field_def[l].max_selected),t=Math.floor(Math.random()*e);f=(m=ps.curMethod.field_def[l].nums.split(" "))[t];s[count-1]=f}}break;case'EXZUX':n.EXZUX=[2];case'SXZS':n.SXZS=[2];case'SXZL':n.SXZL=[3];case'QEZUX':n.QEZUX=[2];case'QSZS':n.QSZS=[2];case'QSZL':n.QSZL=[3];case"ZSZS":n.ZSZS=[2];case"ZSZL":n.ZSZL=[3];case'ZUX24':n.ZUX24=[4];case'ZUX12':n.ZUX12=[1,2];case'ZUX6':n.ZUX6=[2];case'ZUX4':n.ZUX4=[1,1];case'ZUX120':n.ZUX120=[5];case'ZUX60':n.ZUX60=[1,3];case'ZUX30':n.ZUX30=[2,1];case'ZUX20':n.ZUX20=[1,2];case'ZUX10':n.ZUX10=[1,1];case'ZUX5':n.ZUX5=[1,1];for(var c=[],l=1;l<=a;l++){var u=[],p="";e=parseInt(ps.curMethod.field_def[l].max_selected);for(var d=1;d<=n[ps.curMethod.name][l-1];d++){var h=!1;t=Math.floor(Math.random()*e);for(var i in c)if(c[i]===t){h=!0;break}h?d--:(c.push(t),u.push(t),p=u.sort().join(''))}s.push(p)}break;default:for(l=1;l<=a;l++){e=parseInt(ps.curMethod.field_def[l].max_selected),t=Math.floor(Math.random()*e);var m=ps.curMethod.field_def[l].nums.split(" "),f=m[t];s.push(f)}}var y=isLegalCode(s),g=s.join(",");if(0==y.singleNum)return!1;ps.nextProjectCounter++;var b=number_format(2*y.singleNum*ps.curMode,3);$('<li><span class="width1" mid="'+ps.curMethod.method_id+'" mname="'+ps.curMethod.name+'">'+ps.curMethod.cname+'</span><span class="width2">'+g+'</span><span class="width3">'+y.singleNum+'注</span><span class="width4">￥'+b+'</span><span class="xDel">X</span></li>').appendTo("#projectList"),buyBar.updateTotalSingle()},selectRandomBtn_Click:function(){$(this).attr('disabled','true');var e,t=$(this).attr('num');for(e=1;e<=t;e++)buyBar.selectRandom();$(this).removeAttr('disabled')}},traceFunc={multipleStyle_Click:function(){$("#startIssue",parent.document).get(0).selectedIndex=0,$("#traceNum",parent.document).val(1),$("#style1BodyMultiple",parent.document).val(1),1==$(this).val()?($(".style1BodyMultiple",parent.document).live("click",function(){this.focus(),this.select()}).live("keyup",buyBar.checkMultiple).live("keyup",traceFunc.style1BodyMultiple_Keyup),traceFunc.updateStyle1(),$(".multipleNum",parent.document).eq(0).show(),$("#multipleStyle1DIV",parent.document).show(),$("#multipleStyle2DIV",parent.document).hide()):($("#startMultiple",parent.document).click(function(){this.focus(),this.select()}),$("#beitouToolSmainbtzk input",parent.document).click(function(){$(this).parent().click()}).focus(function(){this.select()}),$("#beitouToolSmainbtzk li",parent.document).click(function(){$(this).addClass("checked").siblings().removeClass("checked"),$(this).find("input[name=profitStyle]").attr("checked",!0)}),$(".multipleNum",parent.document).eq(0).hide(),$("#generalPlanBtn",parent.document).click(traceFunc.generalPlanBtn_Click),$("#issuesNum2",parent.document).text("1"),$("#traceTotalAmount",parent.document).text(number_format(2*parseInt($("#singleNum",parent.document).text())*ps.curMode,3)),$("#style2Body",parent.document).empty(),$("#startMultiple",parent.document).val("1"),$("input[name=totalProfitRate]",parent.document).val("10"),$("input[name=first5Rate]",parent.document).val("5"),$("input[name=first5RateValue]",parent.document).val("10"),$("input[name=laterRateValue]",parent.document).val("5"),$("input[name=totalProfit]",parent.document).val("100"),$("input[name=first5Profit]",parent.document).val("5"),$("input[name=first5ProfitValue]",parent.document).val("100"),$("input[name=laterProfitValue]",parent.document).val("50"),$("#beitouToolSmainbtzk li:first",parent.document).click(),$("#multipleStyle1DIV",parent.document).hide(),$("#multipleStyle2DIV",parent.document).show())},startIssue_Change:function(){"1"==$("input[name=multipleStyle]:checked",parent.document).val()?traceFunc.updateStyle1():traceFunc.generalPlanBtn_Click()},traceNum_Keyup:function(){"1"==$("input[name=multipleStyle]:checked",parent.document).val()&&traceFunc.updateStyle1()},traceRemain_Timer_Handle:function(){var e=subTime(ps.curRemainTime);if(ps.curRemainTime>0)$("#remainTimerLabel",parent.document).text(e.day+":"+e.hour+":"+e.minute+":"+e.second),$("#traceBtn").attr("mark",0);else{clearInterval(runTime.traceRemainTimer);var t=subTime(ps.curWaitOpenTime);if($("#remainTimerLabel",parent.document).text(t.day+":"+t.hour+":"+t.minute+":"+t.second),runTime.traceWaitOpenTimer=window.setInterval(traceFunc.traceWaitOpen_Timer_Handle,100),parent.layer.alert("第"+ps.curIssueInfo.issue+"期投注时间已结束，投注内容将进入到下一期！",{icon:7}),1!=$("#traceBtn").attr("mark"))if($("#startIssue",parent.document).children(":first").remove(),$("#startIssue",parent.document).children(":first").text($("#startIssue",parent.document).children(":first").text()+"(当前期)"),"1"==$("input[name=multipleStyle]:checked",parent.document).val()){var a=[];$(".style1BodyMultiple",parent.document).each(function(){a.push(this.value)}),traceFunc.updateStyle1(),$(".style1BodyMultiple",parent.document).each(function(){this.value=a.pop()})}else $("#style2Body li",parent.document).length>0&&traceFunc.generalPlanBtn_Click()}},traceWaitOpen_Timer_Handle:function(){var e=subTime(ps.curWaitOpenTime);$("#remainTimerLabel",parent.document).text(e.day+":"+e.hour+":"+e.minute+":"+e.second),ps.curWaitOpenTime<0&&(clearInterval(runTime.traceWaitOpenTimer),runTime.traceRemainTimer=window.setInterval(traceFunc.traceRemain_Timer_Handle,1e3))},style1BodyMultiple_Keyup:function(){var e=parseInt($(this).val());(isNaN(e)||e<1||e>99999)&&(e=1),/\w+_(\d+)/.test($(this).attr("id"));var t=RegExp.$1;if(0==t)s=0;else{for(var a,n=t-1;n>=0;n--)if($('#check_'+n,parent.document).is(':checked')){a=n;break}var s=parseFloat($("#totalMoney_"+a,parent.document).text())}$("#style1BodyMultiple_"+t,parent.document).val(e);var r=parseInt($("#singleNum",parent.document).text())*e*2*ps.curMode;for($("#curMoney_"+t,parent.document).text(number_format(r,3));t<=$("#style1Body li",parent.document).length;)$('#check_'+t,parent.document).is(':checked')&&(s+=parseFloat($("#curMoney_"+t,parent.document).text()),$("#totalMoney_"+t,parent.document).text(number_format(s,3))),t++;traceFunc.updateTotalMoney()},updateStyle1:function(){var e=-1;if($.each(ps.canTraceIssues,function(t,a){a==$("#startIssue",parent.document).val()&&(e=t)}),-1!=e)if(isNaN(parseInt($("#traceNum",parent.document).val())))$("#style1Body",parent.document).empty();else{$('#style1BodyMultiple',parent.document).val("1");var t=ps.canTraceIssues.slice(e,e+parseInt($("#traceNum",parent.document).val()));t.length<$("#traceNum",parent.document).val()&&(parent.layer.alert("最多只能追"+t.length+"期",{icon:7}),$("#traceNum",parent.document).val(t.length)),$("#style1Body",parent.document).empty();var a,n=0;$('#checkAll',parent.document).attr('checked',!0),$.each(t,function(e,t){a=2*parseInt($("#singleNum",parent.document).text())*ps.curMode,n+=a;var s='<li id="traceIssueLI_'+e+'"><span class="checkbox"><input type="checkbox" id="check_'+e+'" checked /></span><span id="traceIssue_'+e+'">'+t+'</span><span><input type="text" value="1" id="style1BodyMultiple_'+e+'" class="beitouToolsinput style1BodyMultiple " maxlength="5" /></span><span id=curMoney_'+e+">"+number_format(a,3)+"</span><span id=totalMoney_"+e+">"+number_format(n,3)+"</span></li>";$("#style1Body",parent.document).append(s),$(".style1BodyMultiple",parent.document).bind("click",function(){this.focus(),this.select()}).bind("keyup",buyBar.checkMultiple).bind("keyup",traceFunc.style1BodyMultiple_Keyup)}),traceFunc.updateTotalMoney()}},confirmTraceBtn_Click:function(){var e,t,a,n,s,r;if($("#projectList").children("li").each(function(l){e=$(this).children(),n=e.eq(0).attr("mid"),s=e.eq(1).text(),r=!1,a||(a=n,t=n+":",r=!0),a!=n?(t+="#"+n+":",a=n,t+=s):t+=1==r?s:"|"+s}),!ps.canBuy)return parent.layer.alert("该期已截止购买",{icon:7}),!1;if(0==t.length)return parent.layer.alert("请先选择号码再投注",{icon:7}),!1;var l=[];if("1"==$("input[name=multipleStyle]:checked",parent.document).val()?$("#style1Body li",parent.document).each(function(e){if($(this).find("input[type=checkbox]").is(':checked')){var t=$(this).find("span:eq(1)").text(),a=$(this).find("input[type=text]").val();l.push({issue:t,multiple:a})}}):$("#style2Body li",parent.document).each(function(e){var t=$(this).find("span:eq(0)").text(),a=$(this).find("span:eq(1)").text();l.push({issue:t,multiple:a})}),!l||l.length<=0)return parent.layer.alert("追号的期数不能为空",{icon:7}),!1;$("#token").val(getRandChar(32));var i=1==ps.curMode?"2元":.5==ps.curMode?"1元":.1==ps.curMode?"2角":.05==ps.curMode?"1角":.01==ps.curMode?"分":"厘",o=$("#traceTotalAmount",parent.document).text(),c=$("input[name=stopOnWin]",parent.document).attr("checked")?1:0,u='<div id="buy_message">请确认以下投注内容：<br>************************<br>是否追号：是<br>单倍注数：'+$("#totalBetCount").text()+"注<br>总 金 额：￥"+o+"<br>超始期号："+l[0].issue+"<br>追号期数："+l.length+"<br>模&nbsp;&nbsp;式："+i+"模式<br>************************<br></div>";return traceFunc.destroyTracePage(),parent.layer.confirm(u,{icon:7},function(e){$.post("?c=game&a=play",{op:"buy",lotteryId:ps.lotteryId,issue:ps.curIssueInfo.issue,curRebate:ps.rebateGapList[ps.curPrizeIndex].rebate,modes:ps.curMode,codes:t,traceData:l,stopOnWin:c,token:$("#token").val()},function(t){if(0==t.errno){buyBar.removeAll(),drawBar.todayBuyBtnNew_Click();var a='<div id="buy_success_message">追号订单成功!<br>************************<br>订单编号：'+t.pkgnum+"<br>起始期号："+l[0].issue+"<br>追号期数："+l.length+"<br>追号总额：￥"+o+"<br>模&nbsp;&nbsp;式："+i+"模式<br>************************<br></div>";parent.layer.close(e),parent.layer.alert(a,{icon:1}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")})}else parent.layer.close(e),parent.layer.alert("追号失败:"+t.errstr+t.errno,{icon:2})},"json").fail(function(t){parent.layer.close(e),layer.alert("网络异常，请在“游戏记录-追号记录”中确认该订单是否提交成功。",{icon:2})}),parent.$('.xubox_botton').empty(),parent.$('.xubox_botton').html('<div class="LoadingShow"><span class="Loading_icon"></span><span class="Loading_Font">投注中，请稍后...</span></div>')}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")}),!0},cancelTraceBtn_Click:function(){traceFunc.destroyTracePage()},showTracePage:function(e){var t=parent.layer.open({type:1,title:'追号管理',offset:['0','0'],area:['auto','28.44rem'],content:e,success:function(e){var t='';$.each(ps.canTraceIssues,function(e,a){t+='<option value="'+a+'">'+a+'期</option>'}),$("#startIssue",parent.document).html(t).children(":first").text($("#startIssue",parent.document).children(":first").text()+"(当前期)"),$('#maxTraceCount',parent.document).html(ps.canTraceIssues.length)},close:traceFunc.cancelTraceBtn_Click});return $(document,parent.document).one('keyup',function(e){27==(e.keyCode?e.keyCode:e.which)&&(traceFunc.cancelTraceBtn_Click(),parent.layer.close(t))}),t},destroyTracePage:function(){clearInterval(runTime.traceRemainTimer),clearInterval(runTime.traceWaitOpenTimer)},updateTotalMoney:function(){var e=0;"1"==$("input[name=multipleStyle]:checked",parent.document).val()?($("#style1Body li",parent.document).each(function(t){$(this).find("input[type=checkbox]").is(':checked')&&(e+=parseInt($(this).find("input[type=text]").val()))}),$("#issuesNum2",parent.document).text($("#style1Body li input[type=checkbox]:checked",parent.document).length)):($("#style2Body li",parent.document).each(function(t){e+=parseInt($(this).find("span:eq(1)").text())}),$("#issuesNum2",parent.document).text($("#style2Body li",parent.document).length)),$("#traceTotalAmount",parent.document).text(number_format(parseInt($("#singleNum",parent.document).text())*e*2*ps.curMode,3))},generalPlanBtn_Click:function(){var e=function(e,t,a,n,s){if(e=isNaN(parseInt(e))?-1:parseInt(e),t=isNaN(parseInt(t))?-1:parseInt(t),a=isNaN(parseFloat(a))?-1:parseFloat(a),n=isNaN(parseFloat(n))?-1:parseFloat(n),s=parseFloat(s),e<0||t<0||a<0||n<0||s<=0)return 0;var r=0;return a>0&&(t>0?(r=(t/100+1)*n/(s-a*(t/100+1)),r=Math.ceil(round(r,3))):r=1,r>0&&r<e&&(r=e)),r},t=-1;if($.each(ps.canTraceIssues,function(e,a){a==$("#startIssue",parent.document).val()&&(t=e)}),-1==t)throw alert("数据出错"),"数据出错";isNaN(parseInt($("#traceNum",parent.document).val()))&&$("#traceNum",parent.document).val("1");var a=ps.canTraceIssues.slice(t,t+parseInt($("#traceNum",parent.document).val()));a.length<$("#traceNum",parent.document).val()&&(parent.layer.alert("最多只能追"+a.length+"期",{icon:7}),$("#traceNum",parent.document).val(a.length)),$("#style2Body",parent.document).empty();var n,s,r=[],l=0,i=2*parseInt($("#singleNum",parent.document).text())*ps.curMode,o=ps.traceMethodPrize*(ps.rebateGapList[ps.curPrizeIndex].prize/(ps.maxCombPrize*ps.prizeRate))*ps.curMode;$.each(a,function(t,a){if(1==$("input[name=profitStyle]:checked",parent.document).val())if(0==t){if(n=parseInt($("#startMultiple",parent.document).val()),s=n*parseInt($("#singleNum",parent.document).text())*2*ps.curMode,(n*o-s)/s*100<$("input[name=totalProfitRate]",parent.document).val())return parent.layer.alert("该计划无法实现，请调整目标",{icon:7}),!1}else n=e($("#startMultiple",parent.document).val(),$("input[name=totalProfitRate]",parent.document).val(),i,l,o);else if(2==$("input[name=profitStyle]:checked",parent.document).val())if(0==t){if(n=parseInt($("#startMultiple",parent.document).val()),s=n*parseInt($("#singleNum",parent.document).text())*2*ps.curMode,(n*o-s)/s*100<$("input[name=first5RateValue]",parent.document).val())return parent.layer.alert("该计划无法实现，请调整目标",{icon:7}),!1}else n=t<$("input[name=first5Rate]",parent.document).val()?e($("#startMultiple",parent.document).val(),$("input[name=first5RateValue]",parent.document).val(),i,l,o):e($("#startMultiple",parent.document).val(),$("input[name=laterRateValue]",parent.document).val(),i,l,o);else 3==$("input[name=profitStyle]:checked",parent.document).val()?(n=Math.ceil(round((parseInt($("input[name=totalProfit]",parent.document).val())+l)/(o-2*parseInt($("#singleNum",parent.document).text())*ps.curMode),3)))<$("#startMultiple",parent.document).val()&&(n=$("#startMultiple",parent.document).val()):4==$("input[name=profitStyle]:checked",parent.document).val()&&(n=t<$("input[name=first5Profit]",parent.document).val()?Math.ceil(round((parseInt($("input[name=first5ProfitValue]",parent.document).val())+l)/(o-2*parseInt($("#singleNum",parent.document).text())*ps.curMode),3)):Math.ceil(round((parseInt($("input[name=laterProfitValue]",parent.document).val())+l)/(o-2*parseInt($("#singleNum",parent.document).text())*ps.curMode),3)));return 0==n?(parent.layer.alert("您输入的参数有误，必须为正整数",{icon:7}),!1):n<0?(parent.layer.alert("该计划不可能实现，请调整目标",{icon:7}),!1):n*o>ps.tracePrizeLimit?(parent.layer.alert("该计划超出无法实现，请调整目标",{icon:7}),!1):(s=n*parseInt($("#singleNum",parent.document).text())*2*ps.curMode,l+=s,void r.push({issue:a,multiple:n,curMoney:number_format(s,2),totalMoney:number_format(l,2),curPrize:number_format(n*o,2),totalProfit:number_format(n*o-l,2),totalProfitRate:round((n*o-l)/l,2)}))}),traceFunc._showPlan(r)},_showPlan:function(e){$.each(e,function(e,t){var a='<li><span class="spanWidth90px">'+t.issue+'</span><span class="spanWidth50px">'+t.multiple+'</span><span class="spanWidth70px">'+t.curMoney+'</span><span class="spanWidth70px">'+t.totalMoney+'</span><span class="spanWidth70px">'+t.curPrize+'</span><span class="spanWidth70px">'+t.totalProfit+'</span><span class="spanWidth70px">'+Math.round(100*t.totalProfitRate)+"%</span></li>";$("#style2Body",parent.document).append(a)}),traceFunc.updateTotalMoney()}},initDrawBar=function(){$("#curLotteryName").text(ps.lotteryName),$("header p").text(ps.lotteryName),$("#todayIssuesHead").html('<li class="width:30%">期号</li><li class="width:70%">开奖号</li>'),$("#todayDrawBtn").find(drawBar.todayDrawBtn_Click),$("#prizeRankBtn").click(drawBar.prizeRankBtn_Click),drawBar.todayBuyBtnNew_Click(),$.each(ps.openedIssues,function(e,t){t.prop=drawBar.getMoreInfo(t.code),ps.todayDrawList.push(t)}),$("#prizeRankBtn").click(),drawBar.getCurIssue(drawBar.init),$('#thisIssueNumUL').live({mouseenter:function(){''!=$('#original_code').html()&&$('#original_code').fadeIn(200)},mouseleave:function(){$('#original_code').hide().stop()}})},drawBar={init:function(){if(runTime.remainTimer=window.setInterval(drawBar.showCurIssue_Timer,1e3),""==ps.lastIssueInfo.code)ps.getLastOpenTime=0,clearInterval(runTime.getLastOpenTimer),runTime.getLastOpenTimer=window.setInterval(drawBar.getLastOpen_Timer,1e3),$("#thisIssueInfo").addClass("lock"),ps.canBuy=!1,$("#thisIssueSpan").text(ps.lastIssueInfo.issue);else{var e=ps.todayDrawList[0];if(ps.lastIssueInfo.issue!=e.issue){var t=ps.lastIssueInfo,a=drawBar.getMoreInfo(t.code);if(t.prop=a,ps.todayDrawList.unshift(t),$.post("?c=game&a=play",{op:"getBuyRecords",lotteryId:ps.lotteryId,issue:ps.lastIssueInfo.issue},function(e){if(0==e.errno&&0!=e.prj.length){var t=e.prj[0];"已中奖"==t.prizeStatus&&parent.layer.open({title:"中奖通知",offset:'172px',content:'恭喜您中得<span style="color:red">'+ps.lotteryName+'</span>第<span style="color:red">'+t.issue+'</span>期<span style="color:red">￥'+t.prize+'</span>'})}},"json"),$("#todayDrawBtn").hasClass("cur")){var n=ps.todayDrawList[0],s='<ul class="fix"><li class="width:30%">'+n.issue+'</li><li class="width:70%">'+n.code+"</li>";$("#todayIssuesBody").prepend(s)}}}var r;null!=ps.todayDrawList[0].code&&(r=ps.todayDrawList[0].code.split(" ")),$('#thisIssueNumUL').empty(),null!=r&&$.each(r,function(e,t){e<r.length-1?$('#thisIssueNumUL').append('<span class="pendingBall"></span>'):$('#thisIssueNumUL').append('<span class="lan pendingBall"></span><a class="sfnums">特</a>')}),drawBar.showLastDraw(),ps.canBuy=!0},pokerOpenCode:function pokerOpenCode(code){var parts=code.split(' '),trans={s:'poker_heit',h:'poker_hongt',c:'poker_meih',d:'poker_fangk'},poker='',str='<div class="poker_kj">';for(i=0;i<3;i++)poker=parts[i].split(''),str+='<span class="poker_kj_num '+eval('trans.'+poker[1])+'"><i></i><em>'+drawBar.translateT(poker[0])+'</em></span>';return str+='</div>'},getCurIssue:function(e){$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getCurIssue",lotteryId:ps.lotteryId},cache:!1,dataType:"json",timeout:3e4,success:function(t){if(0==t.errno)if(0!=t.kTime){$('#confirmBtn').attr("disabled","disabled"),$('#confirmBtn').css("background","#ccc"),$('#clearProjectBtn').attr("disabled","disabled"),$('#clearProjectBtn').css("background","#ccc");var a=t.kTime/1e3;$('.GameName').text(''),$('#thisIssueNumUL').html("<div style='font-size: 27px;text-align:center;float: left;margin-left: 77px;margin-top:12px;'>休市中...</div>"),$('.issue').text('距离下次开市:'),window.setInterval(function(){var e=subTime(--a);$("#thisIssueRemainTime").html("<span>"+e.hour+"</span><em>:</em><span>"+e.minute+"</span><em>:</em><span>"+e.second+"</span>")},1e3),window.setTimeout(function(){clearInterval(runTime.waitOpenTimer),window.location.reload()},t.kTime)}else ps.curIssueInfo=t.issueInfo,ps.curServerTime=t.serverTime,ps.curRemainTime=getTS(ps.curIssueInfo.end_time)-getTS(ps.curServerTime),ps.curWaitOpenTime=8,ps.lastIssueInfo=t.lastIssueInfo,t.lastIssueInfo&&ps.counters>0&&todayGetCurIssue(t.lastIssueInfo),ps.counters++,"function"==typeof e&&e();else alert("系统繁忙，请稍候再试(02)")},error:function(e,t,a){-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(top.layer.alert("您已经超时退出，请重新登录",{icon:7}),window.location.href="?a=logout"):top.layer.alert("操作超时，请刷新页面..",{icon:7})}})},showCurIssue_Timer:function(){$("#thisIssueSpan").text(ps.curIssueInfo.issue),$("#thisIssueSpan2").text(ps.curIssueInfo.issue);var e=subTime(--ps.curRemainTime);if(ps.curRemainTime>=0)$("#thisIssueRemainTime").html("<span>"+e.day+"</span><em>:</em><span>"+e.hour+"</span><em>:</em><span>"+e.minute+"</span><em>:</em><span>"+e.second+"</span>"),$("#thisIssueTimerIcon").removeClass("lock").addClass('clock').text("可以投注");else{clearInterval(runTime.remainTimer),$('#thisIssueTimerIcon').removeClass('clock').addClass('lock').text("已截止投注");var t=subTime(ps.curWaitOpenTime);layer.alert(ps.lastIssueInfo.issue+'期销售已截止，请进入下一期购买',{icon:7}),$('#thisIssueRemainTime').html("<span>"+t.day+"</span><em>:</em><span>"+t.hour+"</span><em>:</em><span>"+t.minute+"</span><em>:</em><span>"+t.second+"</span>"),ps.canBuy=!1,runTime.waitOpenTimer=window.setInterval(drawBar.waitOpen_Timer,1e3)}},waitOpen_Timer:function(){--ps.curWaitOpenTime;var e=subTime(ps.curWaitOpenTime);$("#thisIssueRemainTime").html("<span>"+e.day+"</span><em>:</em><span>"+e.hour+"</span><em>:</em><span>"+e.minute+"</span><em>:</em><span>"+e.second+"</span>"),ps.curWaitOpenTime<0&&(clearInterval(runTime.waitOpenTimer),drawBar.getCurIssue(drawBar.init))},getLastOpen_Timer:function(){ps.getLastOpenTime++,ps.getLastOpenTime%10==0&&$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getLastIssueCode",lotteryId:ps.lotteryId,issue:ps.lastIssueInfo.issue},cache:!1,dataType:"json",timeout:3e4,success:function(e){if(0==e.errno){if(0!=e.kTime)clearInterval(runTime.waitOpenTimer),window.location.reload();else if(void 0!==e.issueInfo.code){clearInterval(runTime.getLastOpenTimer),ps.getLastOpenTime=0,ps.lastIssueInfo=e.issueInfo,todayGetCurIssue(e.issueInfo);var t=drawBar.getMoreInfo(e.issueInfo.code);if(e.issueInfo.prop=t,ps.todayDrawList.unshift(e.issueInfo),$("#todayDrawBtn").hasClass("cur")){var a=ps.todayDrawList[0],n='<ul><li class="width247px">'+a.issue+'</li><li class="width247px">'+a.code+"</li>";$("#todayIssuesBody").prepend(n)}drawBar.showLastDraw()}}else alert("系统繁忙，请稍候再试(03)")},error:function(e,t,a){-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(top.layer.alert("您已经超时退出，请重新登录",{icon:7}),window.location.href="?a=logout"):top.layer.alert("操作超时，请刷新页面...",{icon:7})}})},showLastDraw:function(){var e=ps.todayDrawList[0];$("#lastIssueSpan").text(ps.lastIssueInfo.issue);var t;if(ps.lastIssueInfo.issue==e.issue){var a=e.code.split(" ");t="<ul><li>第一位：<span>"+a[0]+"</span></li><li>第二位：<span>"+a[0]+","+a[1]+"</span></li></ul><ul><li>第三位：<span>"+a[0]+","+a[1]+","+a[2]+"</span></li></ul>";var n=0,s=0;$("#todayIssuesBody").find("li:first").text()!=ps.curIssueInfo.issue&&drawBar.todayBuyBtnNew_Click(),$(".sfnums").hide();window.setTimeout(function e(){if($("#thisIssueNumUL").children(".pendingBall").length>0){var t=$("#thisIssueNumUL").children(".pendingBall").first();window.setTimeout(function(){t.removeClass("pendingBall sd115Ball").text(a[n++]),t.addClass("sd115_Ball bl"+a[s++]),$(".lan").hasClass("sd115_Ball")&&$(".sfnums").show(),e()},500)}},100)}else $("#thisIssueNumUL").children().addClass("pendingBall").removeClass("sd115_Ball"),t="<ul><li>第一位：<span></span></li><li>第二位：<span></span></li><li>第三位：<span></span></li></ul>";$("#thisIssueMoreInfo").html(t)},todayDrawBtn_Click:function(){$("#todayIssuesHead").html('<li>期号</li><li>开奖号</li>'),$("#todayIssuesBody").empty(),$.each(ps.todayDrawList,function(e,t){for(var a="",n=0;n<t.code.length;n++)"<b>"+t.code[n]+"</b>",a+=t.code[n];var s=a.split(" ").join("</b><b>"),r="<ul class=\"fix1\"><li style=\"width:30%\">第"+t.issue+"期</li><li style=\"width:70%\"><b>"+s+"</b></li></ul>";$("#todayIssuesBody").append(r)})},prizeRankBtn_Click:function(){$("#todayBuyBody").empty().hide(),$.post("?c=game&a=play",{op:"getPrizeRank",lotteryId:ps.lotteryId},function(e){0==e.errno?0==e.data.length?$('<div class="todayNoBet">暂时没有记录！</div>').appendTo("#prizeScrollContent"):($("#prizeScrollContent").empty(),$.each(e.data,function(e,t){$('<ul><li><span>'+t.nick_name+"</span> 喜中 <em>"+number_format(t.total_prize,2)+"</em>元</li></ul>").appendTo($("#prizeScrollContent"))}),$("#prizeScrollContent").html($("#prizeScrollContent").html()+$("#prizeScrollContent").html()).show(),0==runTime.scollTopIntervalTimer&&(runTime.scollTopIntervalTimer=window.setInterval(drawBar.scrollPrizeRank,100),$("#prizeScrollContent").mouseover(function(){clearInterval(runTime.scollTopIntervalTimer)}).mouseout(function(){runTime.scollTopIntervalTimer=window.setInterval(drawBar.scrollPrizeRank,100)}))):alert("暂时没有排行数据！")},"json")},todayBuyBtnNew_Click:function(){$("#todayIssuesBody").find("li:first").text()!=ps.curIssueInfo.issue&&$.post("?c=game&a=play",{op:"getBuyRecords",lotteryId:ps.lotteryId},function(e){0==e.errno?($("#todayBuyBody").empty(),$('<ul><li class="C1">玩法</li><li class="C2">期号</li><li class="C4">金额</li><li class="C5">状态</li></ul><div class="clear"></div>').appendTo("#todayBuyBody"),0==e.prj.length?$('<div class="todayNoBet">暂时没有记录！</div>').appendTo("#todayBuyBody"):$.each(e.prj,function(e,t){$('<ul class="fix"><li class="C1"><a href="javascript:void(0);" onclick="showPackageDetail(\''+t.wrapId+'\');return false;">'+t.methodName+'</a></li><li class="C2">'+helper.getNumByIssue(t.issue)+'</li><li class="C4">'+t.amount+'</li><li class="C5">'+t.prizeStatus+"</li></ul>").click(function(){}).appendTo("#todayBuyBody")})):alert("系统繁忙，请稍候再试(04)")},"json")},scrollPrizeRank:function(){var e=$("#prizeScrollContent")[0];e.scrollTop+=1,e.scrollTop>=$("#prizeScrollContent")[0].scrollHeight/2&&(e.scrollTop=0)},getMoreInfo:function(e){var t={};if(1==ps.lotteryType||4==ps.lotteryType){var a=e.split("");t.qshz=parseInt(a[0])+parseInt(a[1])+parseInt(a[2]),t.qszt=drawBar.zutai(a[0],a[1],a[2]),t.hshz=parseInt(a[2])+parseInt(a[3])+parseInt(a[4]),t.hszt=drawBar.zutai(a[2],a[3],a[4]),t.hehz=parseInt(a[3])+parseInt(a[4]),t.dxds=drawBar.dxds(a[3],a[4])}return t},translateT:function(e){return'T'==e?'10':e},translateCards:function(e){for(var t,a=[],n=0;n<e.length;n++){switch(t={num:"",className:""},e[n].charAt(0)){case'T':t.num='10';break;default:t.num=e[n].charAt(0)}switch(e[n].charAt(1)){case's':t.className='poker_heit';break;case'h':t.className='poker_hongt';break;case'c':t.className='poker_meih';break;case'd':t.className='poker_fangk';break;default:throw new exception('unknown color')}a.push(t)}return a},zutai:function(e,t,a){return e==t&&e==a&&t==a?"豹子":e==t||e==a||t==a?"组三":"组六"},dxds:function(e,t){var a=[],n=[];return a.push(e>=5?"大":"小"),a.push(e%2==1?"单":"双"),n.push(t>=5?"大":"小"),n.push(t%2==1?"单":"双"),[a[0]+n[0],a[0]+n[1],a[1]+n[0],a[1]+n[1]].join(",")},pokerZutai:function(e,t,a){var n=[helper.pokerNumMaps[e.charAt(0)],helper.pokerNumMaps[t.charAt(0)],helper.pokerNumMaps[a.charAt(0)]];return n.sort(),e.charAt(0)==t.charAt(0)&&e.charAt(0)==a.charAt(0)&&t.charAt(0)==a.charAt(0)?"豹子":n[0]+1==n[1]&&n[1]+1==n[2]||1==n[0]&&12==n[1]&&13==n[2]?e.charAt(1)==t.charAt(1)&&e.charAt(1)==a.charAt(1)&&t.charAt(1)==a.charAt(1)?"同花顺":"顺子":e.charAt(1)==t.charAt(1)&&e.charAt(1)==a.charAt(1)&&t.charAt(1)==a.charAt(1)?"同花":e.charAt(0)==t.charAt(0)||t.charAt(0)==a.charAt(0)||e.charAt(0)==a.charAt(0)?"对子":"散牌"}};if(!verifyParams())return parent.layer.alert("数据初始化失败",{icon:2}),!1;initPrizeBar(),initModesBar(),initMethodBar(),initMissHotBar(),initBuyBar(),initDrawBar();var isLegalCode=function(e){if(0==allHasValue(e).charsNum)return{singleNum:0,isDup:0};var t,a=0,n=0;switch(ps.curMethod.name){case'TMZX':case'TMSX':case'TMWS':case'TMSB':case'TMDXDS':case'ZTYM':case'ZTYX':case'ZTWS':t=e[0].split('_'),n=(a=t.length)>1?1:0;break;case'ELX':case'EZE':(t=e[0].split('_')).length>=2&&(a=t.length*(t.length-1)/2),n=a>1?1:0;break;case'SLX':case'SZS':case'SZE':(t=e[0].split('_')).length>=3&&(a=t.length*(t.length-1)*(t.length-2)/6),n=a>1?1:0;break;case'SILX':(t=e[0].split('_')).length>=4&&(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)/24),n=a>1?1:0;break;case'SXZX':case"ZSZX":case'QSZX':n=(a=e[0].length*e[1].length*e[2].length)>1?1:0;break;case'SXZS':case"ZSZS":case'QSZS':n=(a=e[0].length*(e[0].length-1))>2?1:0;break;case'SXZL':case"ZSZL":case'QSZL':n=(a=e[0].length*(e[0].length-1)*(e[0].length-2)/helper.factorial(3))>1?1:0;break;case'SXLX':case"ZSLX":case'QSLX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var s=0,r=0,l=0;s=e[0].length*e[1].length*e[2].length,r=e[1].length*e[2].length,l=e[2].length,n=(a=s+r+l)>3?1:0;break;case'SXBD':case"ZSBD":case'QSBD':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXBD[t]}),n=t.length>1?1:0;break;case'SXHHZX':case"ZSHHZX":case'QSHHZX':n=(a=e[0].length*e[1].length*e[2].length)>1?1:0;break;case'EXZX':case'QEZX':n=(a=e[0].length*e[1].length)>1?1:0;break;case'EXZUX':case'QEZUX':n=(a=e[0].length*(e[0].length-1)/2)>1?1:0;break;case'EXLX':case'QELX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var r=0,l=0;r=e[0].length*e[1].length,l=e[1].length,n=(a=r+l)>2?1:0;break;case'EXBD':case'QEBD':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.EXBD[t]}),n=t.length>1?1:0;break;case'YXZX':n=(a=e[0].length)>1?1:0;break;case'WXDW':for(c=0;c<5;c++)'-'!=e[c]&&(a+=e[c].length);n=a>1?1:0;break;case'SXDW':n=(a=e[0].length+e[1].length+e[2].length)>1?1:0;break;case'EMBDW':case'QSEMBDW':case'ZSEMBDW':case'SXEMBDW':case'WXEMBDW':a=e[0].length*(e[0].length-1)/2,n=0;break;case'WXSMBDW':a=e[0].length*(e[0].length-1)*(e[0].length-2)/6,n=0;break;case'EXDXDS':case'QEDXDS':a=e[0].length*e[1].length==1?1:0,n=0;break;case'SXDXDS':a=e[0].length*e[1].length*e[2].length==1?1:0,n=0;break;case'YMBDW':case'ZSYMBDW':case'SXYMBDW':case'WXYMBDW':case'QSYMBDW':a=e[0].length,n=0;break;case'SXHZ':case"ZSHZ":case'QSHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXHZ[t]}),n=t.length>1?1:0;break;case'EXHZ':case'QEHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.EXHZ[t]}),n=t.length>1?1:0;break;case'SXZXHZ':case'QSZXHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXZXHZ[t]}),n=t.length>1?1:0;break;case'SIXZX':case'QSIZX':n=(a=e[0].length*e[1].length*e[2].length*e[3].length)>1?1:0;break;case'WXZX':n=(a=e[0].length*e[1].length*e[2].length*e[3].length*e[4].length)>1?1:0;break;case'WXLX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var i=0,s=0,r=0,l=0;i=e[0].length*e[1].length*e[2].length*e[3].length*e[4].length,s=e[2].length*e[3].length*e[4].length,r=e[3].length*e[4].length,l=e[4].length,n=(a=i+s+r+l)>4?1:0;break;case'REZX':for(c=0;c<4;c++)if('-'!=e[c])for(u=c+1;u<5;u++)'-'!=e[u]&&(a+=e[c].length*e[u].length);n=a>1?1:0;break;case'RSZX':for(c=0;c<3;c++)if('-'!=e[c])for(u=c+1;u<4;u++)if('-'!=e[u])for(p=u+1;p<5;p++)'-'!=e[p]&&(a+=e[c].length*e[u].length*e[p].length);n=a>1?1:0;break;case'RSIZX':for(var o=0;o<2;o++)if('-'!=e[o])for(var c=o+1;c<3;c++)if('-'!=e[c])for(var u=c+1;u<4;u++)if('-'!=e[u])for(var p=u+1;p<5;p++)'-'!=e[p]&&(a+=e[o].length*e[c].length*e[u].length*e[p].length);n=a>1?1:0;break;case'SDQSZX':if(3!=e.length)return{singleNum:0,isDup:0};d=helper.expandLotto(e);n=(a=d.length)>1?1:0;break;case'SDQEZX':if(2!=e.length)return{singleNum:0,isDup:0};var d=helper.expandLotto(e);n=(a=d.length)>1?1:0;break;case'SDQSZUX':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)/helper.factorial(3))>1?1:0;break;case'SDQEZUX':t=e[0].split('_'),n=(a=t.length*(t.length-1)/2)>1?1:0;break;case'SDRX1':t=e[0].split('_'),n=(a=t.length)>1?1:0;break;case'SDRX2':t=e[0].split('_'),n=(a=t.length*(t.length-1)/2)>1?1:0;break;case'SDRX3':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)/6)>1?1:0;break;case'SDRX4':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)/24)>1?1:0;break;case'SDRX5':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)/120)>1?1:0;break;case'SDRX6':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)/720)>1?1:0;break;case'SDRX7':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)*(t.length-6)/5040)>1?1:0;break;case'SDRX8':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)*(t.length-6)*(t.length-7)/40320)>1?1:0;break;case'SDQSBDW':t=e[0].split('_'),n=(a=t.length)>1?1:0;break;case'SDQSDWD':$.each(e,function(e,n){''!=n&&(t=n.split('_'),a+=t.length)}),n=a>3?1:0;break;case'SDDDS':case'SDCZW':a=1,n=1;break;case'YFFS':case'HSCS':case'SXBX':case'SJFC':n=(a=e[0].length)>1?1:0;break;case'ZUX120':e[0].length>4&&(a=5===e[0].length?1:helper.factorial(e[0].length)/(120*helper.factorial(e[0].length-5))),n=a>1?1:0;break;case'ZUX24':e[0].length>3&&(a=helper.factorial(e[0].length)/(24*helper.factorial(e[0].length-4))),n=a>1?1:0;break;case'ZUX6':e[0].length>1&&(a=helper.factorial(e[0].length)/(2*helper.factorial(e[0].length-2))),n=a>1?1:0;break;case'ZUX10':case'ZUX5':case'ZUX4':if(e[0].length>0&&e[1].length>0){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>0&&(a+=helper.factorial(m)/helper.factorial(m-1))}}n=a>1?1:0;break;case'ZUX20':case'ZUX12':if(e[0].length>0&&e[1].length>1){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>1&&(a+=helper.factorial(m)/(2*helper.factorial(m-2)))}}n=a>1?1:0;break;case'ZUX60':if(e[0].length>0&&e[1].length>2){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>2&&(a+=helper.factorial(m)/(6*helper.factorial(m-3)))}}n=a>1?1:0;break;case'ZUX30':if(e[0].length>1&&e[1].length>0){var h=e[0].length;for(c=0;c<e[1].length;c++){var m=h;e[0].indexOf(e[1].substr(c,1))>-1&&(m=h-1),m>1&&(a+=helper.factorial(m)/(2*helper.factorial(m-2)))}}n=a>1?1:0;break;case'JSETDX':if(2!=e.length)return{singleNum:0,isDup:0};var f=e[0].length?e[0].split('_'):[],y=e[1].length?e[1].split(''):[];n=(a=f.length*y.length)>1?1:0;break;case'JSETFX':t=e[0].split('_'),n=(a=t.length)>1?1:0;break;case'JSHZ':t=e[0].split('_'),a=t.length,n=t.length>1?1:0;break;case'JSSTTX':case'JSSLTX':n=(a=1)>1?1:0;break;case'JSEBT':g=e[0].length;a=(g-1)*g/2,n=g>2?1:0;break;case'JSSTDX':t=e[0].split('_'),a=t.length,n=t.length>1?1:0;break;case'JSSBT':var g=e[0].length;a=(g-1)*(g-2)*g/6,n=g>3?1:0;break;case'PKSZ':case'PKBZ':case'PKDZ':case'PKTH':case'PKTHS':case'PKBX':case'PKRX1':t=e[0].split('_'),n=(a=t.length)>1?1:0;break;case'PKRX2':t=e[0].split('_'),n=(a=t.length*(t.length-1)/2)>1?1:0;break;case'PKRX3':t=e[0].split('_'),n=(a=t.length*(t.length-1)*(t.length-2)/6)>1?1:0;break;case'PKRX4':t=e[0].split('_'),a=t.length;b=t.length;n=(a=b*(b-1)*(b-2)*(b-3)/24)>1?1:0;break;case'PKRX5':b=(t=e[0].split('_')).length;n=(a=b*(b-1)*(b-2)*(b-3)*(b-4)/120)>1?1:0;break;case'PKRX6':var b=(t=e[0].split('_')).length;n=(a=b*(b-1)*(b-2)*(b-3)*(b-4)*(b-5)/720)>1?1:0;break;default:throw"unknown method2 "+ps.curMethod.name}return{singleNum:a,isDup:n}}}}(jQuery);