'use strict';var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};if("object"!=(void 0===console?'undefined':_typeof(console)))var console={info:function(e){window.status=e}};var runTime={remainTimer:0,waitOpenTimer:0,getLastOpenTimer:0,scollTopIntervalTimer:0,traceRemainTimer:0,traceWaitOpenTimer:0,clearAll:function(){clearInterval(runTime.remainTimer),clearInterval(runTime.waitOpenTimer),clearInterval(runTime.getLastOpenTimer),clearInterval(runTime.scollTopIntervalTimer),clearInterval(runTime.traceRemainTimer),clearInterval(runTime.traceWaitOpenTimer)}},mySlotMachine={minRunTime:300,delayStopTime:30,runMethod:1,interval:{},popup:'',buyBarCodes:'',playAgain:0,multiple:0,openCounts:0,openResult:{},fullOpenResult:'',hasPrize:0,runShadePopup:'',startHandleAnimal:function(){var e=document.getElementById('slotMachineButton1');mySlotMachine.interval=setInterval(function(){var t=''==e.style.left?0:parseInt(e.style.left);if(t>0||t<=-234)return e.style.left='0px',clearInterval(mySlotMachine.interval),e.style.disable=!1,!0;e.style.left=t-39+'px'},30)},setOpenCount:function(e){var t='<div class="openCount">第<span class="openCountNum">'+e+'</span>次开奖</div>';$("#multipleOpenCode").html(t)},setHeaderPrizeValue:function(e,t){var a='<div class="getPrizeDiv">恭喜中奖<span class="getPrize">'+floatCaculate.doRound(t,2)+'</span>元</div>';$("#"+e).html(a)},setHeaderNoPrize:function(e){$("#"+e).html("<div class=\"noPrize\">再接再厉</div>")},setPrizeList:function(){var e=parseFloat(mySlotMachine.openResult.prize)>0?'<span>￥'+floatCaculate.doRound(mySlotMachine.openResult.prize,2)+'</span>':'未中奖',t='<tr><td>第'+mySlotMachine.openCounts+'次开奖</td><td>'+mySlotMachine.openResult.opencode+'</td><td>'+e+'</td></tr>';$("#prizeList tbody").append(t);t='<li class="show_code">'+mySlotMachine.openResult.opencode+'</li>';$("#listDiv ul").prepend(t),scrollCode.init()},showLastResult:function(){mySlotMachine.hasPrize>0?mySlotMachine.setHeaderPrizeValue('resultHeader',floatCaculate.doRound(mySlotMachine.hasPrize,2)):mySlotMachine.setHeaderNoPrize('resultHeader'),mySlotMachine.msgPopUpResult()},checkPrize:function(){if(parseFloat(mySlotMachine.openResult.prize)>0){var e=floatCaculate.add(parseFloat(mySlotMachine.hasPrize),parseFloat(mySlotMachine.openResult.prize));return mySlotMachine.hasPrize=floatCaculate.doRound(e,2),!0}return!1},onceShowShade:function(){mySlotMachine.runShadePopup=parent.layer.open({type:1,offset:['0','0'],border:!1,title:!1,area:['auto','auto'],closeBtn:0,shade:[.3,'#000'],time:0,content:$('#onceShowShade')})},msgPopUp4Multiple:function(){mySlotMachine.msgClose(),mySlotMachine.popup=parent.layer.open({type:1,offset:['290px',''],border:!1,title:!1,skin:'layui-layer-nobg',area:['auto','auto'],closeBtn:0,shade:[.3,'#000'],time:0,content:$('#multipleOpenCode')})},msgPopUpResult:function(){mySlotMachine.msgClose(),mySlotMachine.popup=parent.layer.open({type:1,offset:['120px',''],border:!1,title:!1,skin:'layui-layer-nobg',area:['auto','auto'],closeBtn:0,shade:[.3,'#000'],time:0,content:$('#openCodeResult')})},msgClose:function(){''!=mySlotMachine.popup&&parent.layer.close(mySlotMachine.popup)},init:function(){$("#goBack").live("click",function(){mySlotMachine.msgClose(),mySlotMachine.halfClearParams()}),$("#playAgain").live("click",function(){mySlotMachine.hasPrize=0,mySlotMachine.openCounts=0,$("#prizeList td").remove(),mySlotMachine.msgClose(),mySlotMachine.playAgain=1,$("#confirmBtn").click()})},halfClearParams:function(){mySlotMachine.openCounts=0,mySlotMachine.buyBarCodes='',mySlotMachine.playAgain=0,mySlotMachine.openResult={},mySlotMachine.hasPrize=0,mySlotMachine.fullOpenResult='',$("#prizeList td").remove(),$(document).off('mousewheel'),$(document).off('DOMMouseScroll')},clearParams:function(){$("#multiple").val(1),$("#open_counts").val(1),$("#prizeList td").remove(),mySlotMachine.openCounts=0,mySlotMachine.buyBarCodes='',mySlotMachine.multiple=1,mySlotMachine.playAgain=0,mySlotMachine.openResult={},mySlotMachine.hasPrize=0,$("#projectList").empty(),$("#confirmBtn").removeClass('CantapCodeBtn_selected'),$("#totalBetCount").text('0'),$("#totalBetAmount").text('0.00'),$(document).off('mousewheel'),$(document).off('DOMMouseScroll')},onComplete:function(e){if('machine5'==this.element[0].id){var t=$("#open_counts").val(),a=mySlotMachine.checkPrize();if(mySlotMachine.setPrizeList(),t>1)if(mySlotMachine.openCounts>=t)mySlotMachine.showLastResult(),mySlotMachine.fullOpenResult='',showBalance();else{if(1==a){mySlotMachine.setHeaderPrizeValue('multipleOpenCode',mySlotMachine.openResult.prize),mySlotMachine.msgPopUp4Multiple();l=2e3}else var l=0;window.setTimeout("$('#confirmBtn').click()",l)}else''!=mySlotMachine.runShadePopup&&parent.layer.close(mySlotMachine.runShadePopup),mySlotMachine.fullOpenResult='',showBalance(),mySlotMachine.hasPrize>0?mySlotMachine.setHeaderPrizeValue('resultHeader',mySlotMachine.hasPrize):mySlotMachine.setHeaderNoPrize('resultHeader'),mySlotMachine.msgPopUpResult()}},forbideMouseScroll:function(){$(document).scrollTop(0);var e=function(e){if(!(e=e||window.event)||!e.preventDefault)return e.returnvalue=!1,!1;e.preventDefault(),e.stopPropagation()};$(document).on('mousewheel',function(t){e(t)}),$(document).on('DOMMouseScroll',function(t){e(t)})},startOpenCode:function(e,t,a){if($("#token").val(""),0==e.errno&&''!=e.opencode){e=e.data[mySlotMachine.openCounts];var l=$("#open_counts").val();mySlotMachine.forbideMouseScroll(),mySlotMachine.openResult=e,mySlotMachine.buyBarCodes=t,mySlotMachine.multiple=a,mySlotMachine.playAgain=0,mySlotMachine.openCounts++,l>1?(mySlotMachine.setOpenCount(mySlotMachine.openCounts),mySlotMachine.msgPopUp4Multiple(),window.setTimeout(function(){mySlotMachine.startHandleEvent(e.opencode)},1e3)):(mySlotMachine.onceShowShade(),mySlotMachine.startHandleEvent(e.opencode))}else if(65534==e.errno);else{var s="购买失败:"+e.errstr+"(错误代码:"+e.errno+")";if(l>1&&mySlotMachine.openCounts>0)var n=layer.open({dialog:{msg:s,btns:1,type:0,yes:function(){parent.layer.close(n),mySlotMachine.showLastResult()}}});else mySlotMachine.halfClearParams(),parent.layer.alert(s,{icon:2})}},startHandleEvent:function(e){var t=String(e).split(""),a=$("#machine1").slotMachine({active:0,delay:mySlotMachine.minRunTime,spins:mySlotMachine.runMethod,direction:'down'}),l=$("#machine2").slotMachine({active:0,delay:mySlotMachine.minRunTime+mySlotMachine.delayStopTime,spins:mySlotMachine.runMethod,direction:'down'}),s=$("#machine3").slotMachine({active:0,delay:mySlotMachine.minRunTime+2*mySlotMachine.delayStopTime,spins:mySlotMachine.runMethod,direction:'down'}),n=$("#machine4").slotMachine({active:0,delay:mySlotMachine.minRunTime+3*mySlotMachine.delayStopTime,spins:mySlotMachine.runMethod,direction:'down'}),i=$("#machine5").slotMachine({active:0,delay:mySlotMachine.minRunTime+4*mySlotMachine.delayStopTime,spins:mySlotMachine.runMethod,direction:'down'});a.setRandomize(function(){return t[0]}),l.setRandomize(function(){return t[1]}),s.setRandomize(function(){return t[2]}),n.setRandomize(function(){return t[3]}),i.setRandomize(function(){return t[4]}),a.shuffle(15,mySlotMachine.onComplete),l.shuffle(15,mySlotMachine.onComplete),s.shuffle(15,mySlotMachine.onComplete),n.shuffle(15,mySlotMachine.onComplete),i.shuffle(15,mySlotMachine.onComplete)}};!function($){$.init=function(settings){function subTime(e){var t=e>0?{day:Math.floor(e/86400),hour:Math.floor(e%86400/3600),minute:Math.floor(e%3600/60),second:Math.floor(e%60)}:{day:0,hour:0,minute:0,second:0};return 1==(t.hour+"").length&&(t.hour="0"+t.hour),1==(t.minute+"").length&&(t.minute="0"+t.minute),1==(t.second+"").length&&(t.second="0"+t.second),t}function allHasValue(e){var t=1,a=0;return $.each(e,function(e,l){a+=l.length,0==l.length&&(t=0)}),{flag:t,charsNum:a}}var verifyParams=function(){var e=0;return void 0==settings.lotteryId||!is_numeric(settings.lotteryId)||settings.lotteryId<=0?e=-1:void 0==settings.lotteryName||''==settings.lotteryName?e=-2:void 0!=settings.lotteryType&&is_numeric(settings.lotteryType)&&-1!=$.inArray(settings.lotteryType,[1,2,4,5,6,7])?void 0!=settings.methods&&$.isArray(settings.methods)&&0!=settings.methods.length?void 0!=settings.minRebateGaps&&$.isArray(settings.minRebateGaps)&&0!=settings.minRebateGaps.length?void 0==settings.rebate||!is_numeric(settings.rebate)||settings.rebate<0||settings.rebate>.15?e=-7:void 0!=settings.defaultMode&&is_numeric(settings.defaultMode)&&-1!=!$.inArray(settings.defaultMode,[1,.1,.01])?void 0==settings.defaultRebate||!is_numeric(settings.defaultRebate)||settings.defaultRebate<0||settings.defaultRebate>settings.rebate?e=-9:(void 0==settings.maxCombPrize||!is_numeric(settings.maxCombPrize)||settings.maxCombPrize<=0)&&(e=-10):e=-8:e=-6:e=-4:e=-3,e<0&&console.info('参数错误：flag='+e),0==e},ps=$.extend({counter:0,lotteryId:1,lotteryName:'CQSSC',lotteryType:1,methods:[],maxCombPrize:0,openedIssues:[],minRebateGaps:[{from:0,to:.12,gap:.005},{from:.12,to:.125,gap:.001}],rebate:.123,defaultMode:1,defaultRebate:.123,missHot:{miss:[],hot:[]},halt:function(e){throw alert(e+'!'),e},prizeRate:0,curIssueInfo:{},lastIssueInfo:{},curMode:0,curMethod:{},curProjects:[],nextProjectCounter:0,curPrizeIndex:-1,rebateGapList:[],todayDrawList:[],curServerTime:'',curRemainTime:0,remainTimer:{},curWaitOpenTime:0,waitOpenTimer:{},getLastOpenTime:0,getLastOpenTimer:{},canBuy:!1,traceMethodPrize:0,tracePrizeLimit:0,canTraceIssues:[]},settings),helper={SXBD:{0:1,1:1,2:2,3:3,4:4,5:5,6:7,7:8,8:10,9:12,10:13,11:14,12:15,13:15,14:15,15:15,16:14,17:13,18:12,19:10,20:8,21:7,22:5,23:4,24:3,25:2,26:1,27:1},EXBD:{0:1,1:1,2:2,3:2,4:3,5:3,6:4,7:4,8:5,9:5,10:5,11:4,12:4,13:3,14:3,15:2,16:2,17:1,18:1},SXHZ:{0:1,1:3,2:6,3:10,4:15,5:21,6:28,7:36,8:45,9:55,10:63,11:69,12:73,13:75,14:75,15:73,16:69,17:63,18:55,19:45,20:36,21:28,22:21,23:15,24:10,25:6,26:3,27:1},EXHZ:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,10:9,11:8,12:7,13:6,14:5,15:4,16:3,17:2,18:1},SXZXHZ:{1:1,2:2,3:2,4:4,5:5,6:6,7:8,8:10,9:11,10:13,11:14,12:14,13:15,14:15,15:14,16:14,17:13,18:11,19:10,20:8,21:6,22:5,23:4,24:2,25:2,26:1},factorial:function(e){return e<=1?1:e*helper.factorial(e-1)},getNumByIssue:function(e){if(0==e.length)return!1;var t=e.indexOf("-");return-1!=t?e.substr(t+1):e.substr(e.length-3)},expandLotto:function(e){var t=[],a=[],l=0;if($.each(e,function(e,t){if(""!=$.trim(t)){var s=t.split("_");s.sort(),a.push(s)}else l=1}),l)return[];var s,n,i,r,o;switch(e.length){case 2:for(s=0;s<a[0].length;s++)for(n=0;n<a[1].length;n++)t.push(a[0][s]+" "+a[1][n]);break;case 3:for(s=0;s<a[0].length;s++)for(n=0;n<a[1].length;n++)for(i=0;i<a[2].length;i++)t.push(a[0][s]+" "+a[1][n]+" "+a[2][i]);break;case 5:for(s=0;s<a[0].length;s++)for(n=0;n<a[1].length;n++)for(i=0;i<a[2].length;i++)for(r=0;r<a[3].length;r++)for(o=0;o<a[4].length;o++)t.push(a[0][s]+" "+a[1][n]+" "+a[2][i]+" "+a[2][r]+" "+a[2][o]);break;default:throw"unkown expand"}var c=[];return $.each(t,function(e,t){var a=t.split(" ");array_unique(a).length==a.length&&c.push(t)}),c}},initModesBar=function(){var e=1,t=parseFloat(getCookie("mod_"+ps.lotteryId));switch($.each([1,.1,.01],function(a,l){l==t&&(e=l)}),ps.curMode=e,$("#yuan").click(function(){$("#yuan").removeClass().addClass("yuan"),$("#jiao").removeClass().addClass("jiao_off"),$("#fen").removeClass().addClass("fen_off"),$("#modesDIV").val(1),modesBar.modesBtn_Click()}),$("#jiao").click(function(){$("#jiao").removeClass().addClass("jiao"),$("#yuan").removeClass().addClass("yuan_off"),$("#fen").removeClass().addClass("fen_off"),$("#modesDIV").val(.1),modesBar.modesBtn_Click()}),$("#fen").click(function(){$("#fen").removeClass().addClass("fen"),$("#jiao").removeClass().addClass("jiao_off"),$("#yuan").removeClass().addClass("yuan_off"),$("#modesDIV").val(.01),modesBar.modesBtn_Click()}),ps.curMode){case 1:$("#yuan").click();break;case.1:$("#jiao").click();break;case.01:$("#fen").click()}},modesBar={modesBtn_Click:function(){var e=$("#modesDIV").val();$('#projectList').children('li').length>0?layer.confirm('切换元角分模式将影响您现有投注项，是否继续？',{icon:7},function(t){ps.curMode=e,buyBar.updateTotalSingle(),0!=$('#betCount').text()&&buyBar.updateSingle($('#betCount').text()),modesBar.saveLastModes(),prizeBar.showPirze(),layer.close(t)},function(e){switch(ps.curMode){case'1':$("#yuan").removeClass().addClass("yuan"),$("#jiao").removeClass().addClass("jiao_off"),$("#fen").removeClass().addClass("fen_off");break;case'0.1':$("#yuan").removeClass().addClass("yuan_off"),$("#jiao").removeClass().addClass("jiao"),$("#fen").removeClass().addClass("fen_off");break;case'0.01':$("#yuan").removeClass().addClass("yuan_off"),$("#jiao").removeClass().addClass("jiao_off"),$("#fen").removeClass().addClass("fen")}$("#modesDIV").val(ps.curMode)}):(ps.curMode=e,0!=$('#betCount').text()&&buyBar.updateSingle($('#betCount').text()),modesBar.saveLastModes(),prizeBar.showPirze())},saveLastModes:function(){setCookie('mod_'+ps.lotteryId,ps.curMode,2592e3)}},initPrizeBar=function(){ps.rebateGapList=prizeBar.generateGapList(),0==ps.rebateGapList.length&&ps.halt("initPrizeBar failed"),ps.curPrizeIndex=ps.rebateGapList.length-1,prizeBar.showPirze(),$('#curPrizeSpan').change(prizeBar.changePrize)},prizeBar={changePrize:function(){if(!0!==$.isEmptyObject(ps.curMethod)&&ps.curMethod.description.indexOf("@P@")>0){for(var e=$("#curPrizeSpan option:selected").text().split("/"),t='',a=ps.curMethod.description.split("@P@"),l=1;l<a.length;l++)void 0!=ps.curMethod.prize[l]&&(t+=a[l-1]+Math.round(ps.curMethod.prize[l]*e[0]/ps.curMethod.prize[1]*1e4)/1e4+"元");t+=a[a.length-1],$("#methodDesc").text(t)}ps.curPrizeIndex=$("#curPrizeSpan").val(),prizeBar.saveLastPrize(),buyBar.updateTotalSingle()},generateGapList:function(){var e=[];$.each(ps.minRebateGaps,function(t,a){if(a.from=parseFloat(a.from),a.to=parseFloat(a.to),a.gap=parseFloat(a.gap),ps.rebate>a.to)for(var l=a.from;l<=a.to;l+=a.gap)e.push(parseFloat(number_format(l,3)));else{for(l=a.from;l<a.to&&l<ps.rebate;l+=a.gap)e.push(parseFloat(number_format(l,3)));e.push(parseFloat(number_format(ps.rebate,3)))}}),e=array_unique(e);var t=[];return $.each(e,function(e,a){if(7==ps.lotteryType)l=Math.floor(ps.maxCombPrize/24*(ps.prizeRate+a),0);else var l=round(ps.maxCombPrize*(ps.prizeRate+a),0);t.push({rebate:round(ps.rebate-a,3),prize:l})}),t},showPirze:function(){!0!==$.isEmptyObject(ps.curMethod)&&($('#curPrizeSpan').empty(),$.each(ps.rebateGapList,function(e,t){var a=round(ps.curMode*ps.curMethod.prize[1]*(ps.prizeRate+ps.rebate-ps.rebateGapList[e].rebate)/ps.prizeRate,2),l=number_format(100*parseFloat(ps.rebateGapList[e].rebate),1);$('#curPrizeSpan').append('<option value="'+e+'">'+a+'/'+l+'%</option>')}),$("#curPrizeSpan").val(ps.curPrizeIndex),prizeBar.changePrize(),15==ps.lotteryId&&($('#selectRebate').slider({range:'min',min:0,max:$('#curPrizeSpan option').length-1,value:$('#curPrizeSpan option:selected').index(),slide:function(e,t){$('#curPrizeSpan option').removeAttr('selected'),$('#curPrizeSpan option').eq(t.value).attr('selected',!0),$('#rebateValue').html($('#curPrizeSpan option').eq(t.value).html()),$('#curPrizeSpan').change(),ps.curPrizeIndex=t.value}}),$('#rebateValue').html($('#curPrizeSpan option:selected').html())))},saveLastPrize:function(){setCookie("reb_"+ps.lotteryId,ps.rebateGapList[ps.curPrizeIndex].rebate,2592e3)}},initMethodBar=function(){$.each(ps.methods,function(e,t){1==t.childs.length?$('<li class="methodGroupLI" id="methodGroup_'+e+'"><label>'+t.mg_name+"</label></li>").click(methodBar.methodGroup_Click).appendTo("#methodGroupContainer"):$('<li class="methodGroupLI" id="methodGroup_'+e+'"><label>'+t.mg_name+"</label></li>").click(methodBar.methodGroup_Click).hover(methodBar.methodGroup_hoverOver,methodBar.methodGroup_hoverOut).appendTo("#methodGroupContainer");var a,l='<dl class="fix"><dt>直选：</dt>',s='<dl class="fix"><dt>组选：</dt>',n='<dl class="fix"><dt>趣味：</dt>',i='<dl class="fix"><dt>特殊：</dt>',r='<dl class="fix"><dt>定位：</dt>',o='<dl class="fix"><dt>不定位：</dt>',c='<dl class="fix"><dt>任选二：</dt>',u='<dl class="fix"><dt>任选三：</dt>',p='<dl class="fix"><dt>任选四：</dt>',d='<dl class="fix"><dt>其他：</dt>';a=0==e?$('<div id="method_'+e+'" class="methodControl"></div>').addClass('methodPopStyle'):$('<div id="method_'+e+'" class="methodControl"></div>').addClass('methodPopStyle').hide(),$.each(t.childs,function(t,a){var h='<dd class="method" name="'+a.name+'" pid="method_'+e+'" id="method_'+e+"_"+t+'">'+a.cname+'</dd>';1==a.method_property?l+=h:2==a.method_property?s+=h:3==a.method_property?n+=h:4==a.method_property?i+=h:5==a.method_property?r+=h:6==a.method_property?o+=h:7==a.method_property?c+=h:8==a.method_property?u+=h:9==a.method_property?p+=h:0==a.method_property&&(d+=h)}),s+='</dl>',n+='</dl>',i+='</dl>',r+='</dl>',o+='</dl>',c+='</dl>',u+='</dl>',p+='</dl>',d+='</dl>',(l+='</dl>').indexOf('</dd>')<0&&(l=''),s.indexOf('</dd>')<0&&(s=''),n.indexOf('</dd>')<0&&(n=''),i.indexOf('</dd>')<0&&(i=''),r.indexOf('</dd>')<0&&(r=''),o.indexOf('</dd>')<0&&(o=''),c.indexOf('</dd>')<0&&(c=''),u.indexOf('</dd>')<0&&(u=''),p.indexOf('</dd>')<0&&(p=''),d.indexOf('</dd>')<0&&(d=''),$(l+s+n+i+r+o+c+u+p+d).appendTo(a),$.each(t.childs,function(t,a){$('#method_'+e+"_"+t).live("click",a,methodBar.method_Click).hover(methodBar.method_hoverOver,methodBar.methodGroup_hoverOut)}),$("#methods").append(a)}),$(".subTopBar").mouseleave(function(){$(this).find("div").removeClass("methodGroup_hover")}),methodBar.selectDefault()},methodBar={methodGroup_Click:function(e){$(this).addClass("methodGroup_selected").siblings().removeClass("methodGroup_selected methodGroup_hover"),$(e.target).is('label')&&$(this).find('dd:first').click(),$(this).addClass("methodGroup_hover"),/\w+_(\d+)/.test($(this).attr("id"));var t=RegExp.$1;$(".playNav ul .methodPopStyle").hide(),$(this).find('.methodPopStyle').show(),$(".methodControl").hide(),$("#method_"+t).show(),$("#method_"+t+"_0").click()},methodGroup_hoverOver:function(){$(this).addClass("methodGroup_hover"),$(this).hasClass("methodGroup_selected")&&$(this).find('.methodPopStyle').show()},methodGroup_hoverOut:function(){$(this).removeClass("methodGroup_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1},method_hoverOver:function(){$(this).addClass("method_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1;$(this).find('.methodPopStyle').show()},method_hoverOut:function(){$(this).removeClass("method_hover"),/\w+_(\d+)/.test($(this).attr("id"));RegExp.$1;$(this).find('.methodPopStyle').hide()},method_Click:function(e){ps.curMethod=e.data;var t=$(this),a=t.attr("pid");$("#"+a).find('.method').removeClass("method_selected"),t.addClass("method_selected"),$('#curMethod').text(ps.curMethod.cname),$("#methodDesc").text(ps.curMethod.description).hide(),$("#methodTipInfo").hover(function(){layer.tips($("#methodDesc").text(),this,{tips:[2,'#F26C4F'],maxWidth:250,time:0,closeBtn:0})},function(){layer.closeAll('tips')}),ballBar.generateBall(),$("#singleInfo").show(),buyBar.updateSingle(0),prizeBar.showPirze(),0==propLen(ps.curMethod.field_def)&&($(".selectRandomBtn").hide(),ballBar.showInput(),$("#singleInfo").hide(),$("#selectArea").removeClass("N-selected")),2==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","10px 0"),3==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","10px 0"),4==propLen(ps.curMethod.field_def)&&$(".locate").css("padding","5px 0")},selectDefault:function(){if(1==ps.lotteryType)$("#methodGroupContainer").find("label:contains('后三')").click(),$("#methodGroupContainer").find("label:contains('P3直选')").click();else if(2==ps.lotteryType){var e=$("#methodGroupContainer").find("label:contains('任选')");e.click(),e.siblings('ul').children(":contains('任选五中五')").click()}else 4==ps.lotteryType?$("#methodGroupContainer").find("label:contains('直选')").click():6==ps.lotteryType?$("#methodGroupContainer").find("label:contains('和值')").click():7==ps.lotteryType&&$("#methodGroupContainer").find("label:contains('包选')").click();$(".playNav ul ul").hide()}},ballBar={reset:function(){$.isEmptyObject(ps.curMethod.field_def)||($.each(ps.curMethod.field_def,function(e,t){$('#field_'+e).children().removeClass('ball_Selected')}),15==ps.lotteryId&&($(".all_button_off").removeClass("all_button_on"),$(".big_button_off").removeClass("big_button_on"),$(".small_button_off").removeClass("small_button_on"),$(".single_button_off").removeClass("single_button_on"),$(".double_button_off").removeClass("double_button_on"),$(".clear_button_off").removeClass("clear_button_on")),buyBar.updateSingle(0))},showInput:function(){if($("#selectArea").children().remove(),1==ps.lotteryType){var e='<div class="manualInput"><div class="manualInputTop fix"><ul><li><p class="NumbBasket">号码篮</p><textarea cols="" rows="" class="inputTA" id="inputTA"></textarea></li><li id="delTA" class="delTA custBtnStyle">清空号码</li></div><div class="manualInputBottom fix"><li class="inputTip1"><p>提示：</p><p>请把您已有的大底号码复制或者输入到下边文本框中。</p><p>每注号码之间用 空格 或者换行符 隔开,</p><p>每注号码每位之间不使用任何分隔符。仅支持单式。 </p></li><li class="inputTip2"><p>例如：</p><p id="inputExample">',t=[1,2,3,4,5,6,7,8,9,0];"SXHHZX"==ps.curMethod.name||"ZSHHZX"==ps.curMethod.name||"QSHHZX"==ps.curMethod.name?e+="123 112<br></p></li></ul></div></div>":e+=t.slice(0,propLen(ps.curMethod.field_def)).join("")+" "+t.slice(propLen(ps.curMethod.field_def),propLen(ps.curMethod.field_def)+propLen(ps.curMethod.field_def)).join("")+"<br></p></li></div></div>"}else if(2==ps.lotteryType){var a,e='<div class="manualInput"><div class="manualInputTop fix"><ul><li><p class="NumbBasket">号码篮</p><textarea cols="" rows="" class="inputTA" id="inputTA"></textarea></li><li id="delTA" class="delTA custBtnStyle">清空号码</li></div><div class="manualInputBottom fix"><li class="inputTip1"><p>提示：</p><p>请把您已有的大底号码复制或者输入到下边文本框中。</p><p>每注号码之间必须用 换行  隔开,</p><p>每注号码每位之间必须使用 空格 作为分隔。仅支持单式。 </p></li><li class="inputTip2"><p>例如：</p><p id="inputExample">',t=["01","02","03","04","05","06","07","08","09","10","11"];a=/SDRX(\d+)/.test(ps.curMethod.name)?parseInt(RegExp.$1):'SDQSZUX'==ps.curMethod.name?3:'SDQEZUX'==ps.curMethod.name?2:propLen(ps.curMethod.field_def),e+=t.slice(0,a).join(" ")+"<br/>"+t.slice(1,1+a).join(" ")+"<br></p></li></ul></div></div>"}else if(4==ps.lotteryType){var e='<div class="manualInput"><div class="manualInputTop fix"><ul><li><p class="NumbBasket">号码篮</p><textarea cols="" rows="" class="inputTA" id="inputTA"></textarea></li><li id="delTA" class="delTA custBtnStyle">清空号码</li></div><div class="manualInputBottom fix"><li class="inputTip1"><p>提示：</p><p>请把您已有的大底号码复制或者输入到下边文本框中。</p><p>每注号码之间用 空格 或者换行符 隔开,</p><p>每注号码每位之间不使用任何分隔符。仅支持单式。 </p></li><li class="inputTip2"><p>例如：</p><p id="inputExample">',t=[1,2,3,4,5,6,7,8,9,0];"SXHHZX"==ps.curMethod.name?e+="123 112<br></p></li></ul></div></div>":e+=t.slice(0,propLen(ps.curMethod.field_def)).join("")+" "+t.slice(propLen(ps.curMethod.field_def),propLen(ps.curMethod.field_def)+propLen(ps.curMethod.field_def)).join("")+"<br></p></li></ul></div></div>"}$(e).appendTo("#selectArea"),$("#delTA").click(function(){$("#inputTA").val("")}),$("#inputTA").keyup(function(){''!=$("#inputTA").val()&&$("#selectCodeBtn").addClass('selectCodeBtn_selected')})},generateBall:function(){$("#selectArea").children().remove();var e='<li class="Quick">';e+='<input type="button" class="all_button_off" value="全">',e+='<input type="button" class="big_button_off" value="大">',e+='<input type="button" class="small_button_off" value="小">',e+='<input type="button" class="single_button_off" value="单">',e+='<input type="button" class="double_button_off" value="双">',e+='<input type="button" class="clear_button_off" value="清">',e+='</li>',$.each(ps.curMethod.field_def,function(t,a){var l=a.nums.split(" "),s='',n="";$.each(l,function(e,t){switch(ps.curMethod.name){case"SXBD":case"ZSBD":case"QSBD":s+='<li>'+t+'</li>',n+='<li>'+helper.SXBD[e]+'</li>';break;case"SXHZ":case"ZSHZ":case"QSHZ":s+='<li>'+t+'</li>',n+='<li>'+helper.SXHZ[e]+'</li>';break;case"EXBD":case"QEBD":s+='<li>'+t+'</li>',n+='<li>'+helper.EXBD[e]+'</li>';break;case"EXHZ":case"QEHZ":s+='<li>'+t+'</li>',n+='<li>'+helper.EXHZ[e]+'</li>';break;case'SXZXHZ':case'QSZXHZ':s+='<li>'+t+'</li>',n+='<li>'+helper.SXZXHZ[e+1]+'</li>';break;default:s+='<li>'+t+"</li>"}});s="<li><ul class=\"ballList"+(/(BD|HZ)$/.test(ps.curMethod.name)?" w400":"")+'" id=field_'+t+">"+s+"</ul></li>",n='<li><ul class="BDHZinfo">'+n+"</ul></li>";var i="";if(/(DXDS)$/.test(ps.curMethod.name)?i=' DXDS-margin-left':/(SDDDS)$/.test(ps.curMethod.name)?i=' SDDDS-margin-left':/(SDCZW)$/.test(ps.curMethod.name)&&(i=' SDCZW-margin-left'),6!=ps.lotteryType||'JSSTTX'!=ps.curMethod.name&&'JSSLTX'!=ps.curMethod.name?$('<div class="locate" id="locate_'+t+'"><ul class="lotteryNumber'+i+'">'+(a.prompt?'<li class="areaPrefix">'+a.prompt+"</li>":"")+s+"</ul></div>").appendTo("#selectArea"):$('<div class="locate" id="locate_'+t+'"><ul class="lotteryNumber k3">'+s+"</ul></div>").appendTo("#selectArea"),a.has_filter_btn)if(7==ps.lotteryType)$(".lotteryNumber").first().append(e),$('.allSelect').click(function(){$(".lotteryNumber li ul li").addClass('ball_Selected'),ballBar.computeSingle()}),$('.clearSelect').click(function(){$(".lotteryNumber li ul li").removeClass('ball_Selected'),ballBar.computeSingle()});else{$("#locate_"+t).find("ul").first().append(e),"EXZUX"!=ps.curMethod.name&&"QEZUX"!=ps.curMethod.name||$("#locate_"+t).find(".QuickChoose").hide();var r=$("#locate_"+t).find(".Quick input");r.click(function(){var e=this.className.split('_');switch(e[0]+"_"+e[1]){case'all_button':$('#field_'+t).children().addClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('all_button_on');break;case'single_button':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+t).children().removeClass('ball_Selected').parent().find(":odd").addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+t).children().removeClass('ball_Selected').parent().find(":even").addClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('single_button_on');break;case'double_button':1==ps.lotteryType||4==ps.lotteryType?$('#field_'+t).children().removeClass('ball_Selected').parent().find(":even").addClass('ball_Selected'):2==ps.lotteryType&&$('#field_'+t).children().removeClass('ball_Selected').parent().find(":odd").addClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('double_button_on');break;case'big_button':$('#field_'+t).children().removeClass('ball_Selected').filter(function(e){return e>=5}).addClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('big_button_on');break;case'small_button':$('#field_'+t).children().removeClass('ball_Selected').filter(function(e){return e<5}).addClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('small_button_on');break;case'clear_button':$('#field_'+t).children().removeClass('ball_Selected'),ballBar.changeFilterButtonClass(r),$(this).addClass('clear_button_on')}ballBar.computeSingle()})}var o=[];o.length>0&&$.each(o,function(e,t){$(t).appendTo('#selectArea')})}),$('.lotteryNumber ul>li').bind("click",ballBar.ball_Click)},changeFilterButtonClass:function(e){var t=['all_button_off','big_button_off','small_button_off','single_button_off','double_button_off','clear_button_off'];e.each(function(e){$(this).removeClass().addClass(t[e])})},getAssisInfo:function(e){var t="",a=[];if(!$.isArray(ps.missHot.miss)||!$.isArray(ps.missHot.hot))return[];var l=-1;switch(ps.curMethod.name){case"QSZX":case"QSLX":case"QEZX":case"QELX":case"QSIZX":case"WXZX":case"WXLX":case"WXDW":case'SXDW':case"SDQSZX":case"SDQEZX":l=e-1+0;break;case"SIXZX":case"ZSZX":case"ZSLX":l=e-1+1;break;case"SXZX":case"SXLX":l=e-1+2;break;case"EXZX":case"EXLX":l=e-1+3;break;case"YXZX":l=e-1+4}return l>-1&&($.each(ps.missHot.miss[l],function(e,a){t+='<li class="yiLouNum">'+a+"</li>"}),t='<div class="missDIV" id="missHot_'+e+'"><ul class="missHotNumber"><li class="missHotUnit">遗漏:</li><li><ul class="yiLouList" id=yiLouList_'+e+">"+t+"</ul></li></ul></div>",a.push(t),t="",$.each(ps.missHot.hot[l],function(e,a){t+='<li class="yiLouNum">'+a+"</li>"}),t='<div class="hotDIV" id="missHot_'+e+'"><ul class="missHotNumber"><li class="missHotUnit">冷热:</li><li><ul class="yiLouList" id=yiLouList_'+e+">"+t+"</ul></li></ul></div>",a.push(t)),a},ball_Click:function(e){$(this).toggleClass("ball_Selected"),/\w+_(\d+)/.test($(this).parent().attr("id"));var t=RegExp.$1;$(this).parent().find(".ball_Selected").length>ps.curMethod.field_def[t].max_selected?1==ps.curMethod.field_def[t].max_selected?$(this).siblings(".ball_Selected").removeClass("ball_Selected"):($(this).removeClass("ball_Selected"),parent.layer.alert("当前最多只能选择"+ps.curMethod.field_def[t].max_selected+"个号码",{icon:7})):('JSETDX'==ps.curMethod.name&&$('#locate_'+(1==t?2:1)).find(".ballList_k3no_square li").eq(parseInt($(this).text().substr(0,1))-1).removeClass("ball_Selected"),ballBar.computeSingle())},computeSingle:function(){var e=[];$.each(ps.curMethod.field_def,function(t,a){var l="",s=ps.curMethod.field_def[t].nums.split(" ");$("#field_"+t+" li").each(function(e){$(this).hasClass("ball_Selected")&&(2==ps.lotteryType||ps.curMethod.field_def[t].max_selected>10||s[s.length-1].length>1?7==ps.lotteryType?l+=$(this).find('div').attr("zhuma")+"_":l+=$(this).text()+"_":7==ps.lotteryType?l+=$(this).find('div').attr("zhuma"):l+=$(this).text())}),-1==l.indexOf("_")?e.push(l):e.push(l.substr(0,l.length-1))});var t=isLegalCode(e);buyBar.updateSingle(t.singleNum),'WXDW'!=ps.curMethod.name&&'REZX'!=ps.curMethod.name&&'RSZX'!=ps.curMethod.name&&'RSIZX'!=ps.curMethod.name||$.each(e,function(t,a){''==a&&(e[t]='-')});var a=e.join(",");return'JSSTTX'==ps.curMethod.name?a='111_222_333_444_555_666':'JSSLTX'==ps.curMethod.name&&(a='123_234_345_456'),{singleNum:t.singleNum,isDup:t.isDup,code:a}}},initMissHotBar=function(){$("input[name=missHotBtn]").click(missHotBar.missHotBtn_Click),$('input[name=missHotBtn][value="1"]').click()},missHotBar={missHotBtn_Click:function(){"1"==$(this).val()?($("#selectArea .missDIV").removeClass("hidden"),$("#selectArea .hotDIV").addClass("hidden")):($("#selectArea .missDIV").addClass("hidden"),$("#selectArea .hotDIV").removeClass("hidden"))}},initBuyBar=function(){ps.nextProjectCounter=0,buyBar.removeAll(),$("#multiple").click(function(){this.focus(),this.select()}).blur(function(){''!=this.value&&0!=this.value||(this.value=1,buyBar.updateTotalSingle())}).keyup(buyBar.checkMultiple).keyup(buyBar.updateTotalSingle),$(".minus").click(function(){var e=parseInt($("#multiple").val()),t=e<=1?1:e-1;$("#multiple").val(t),$("#multiple").keyup(),$("#multiple").keyup()}),$(".plus").click(function(){var e=parseInt($("#multiple").val())+1;$("#multiple").val(e),$("#multiple").keyup(),$("#multiple").keyup()}),$("#plusBtn").click(buyBar.plusBtn_Click),$("#minusBtn").click(buyBar.minusBtn_Click),$("#open_counts").live("click",function(){this.focus(),this.select()}).live("blur",function(){''!=this.value&&0!=this.value||(this.value=1)}).live("keyup",function(){this.value=this.value.replace(/^0|[^\d]/g,'');return!($(this).val()>30)||(parent.layer.alert("请输入正确的数值，最大为30次",{icon:7}),$(this).val(30),!0)}).live("keyup",traceFunc.style1BodyMultiple_Keyup),$(".open_counts .arrow").click(function(e){e.stopPropagation(),$("#open_counts_option").show(),$(document).live("click",function(){$("#open_counts_option").hide()})}),$("#open_counts_option li").click(function(){var e=$(this).html();$("#open_counts").val(e)}),$(".xDel").live("click",function(){$(this).parent().remove(),buyBar.updateTotalSingle()}),$("#clearProjectBtn").click(buyBar.removeAll),$("#inputBtn").click(buyBar.inputBtn_Click),$("#selectCodeBtn").click(buyBar.selectCodeBtn_Click),$("#confirmBtn").click(buyBar.confirmBtn_Click),$("#slotMachineButton1").click(function(){mySlotMachine.startHandleAnimal(),$("#confirmBtn").click()}),$("#traceBtn").click(buyBar.traceBtn_Click),$(".selectRandomBtn").click(buyBar.selectRandomBtn_Click)},buyBar={plusBtn_Click:function(){var e=$("#multiple").val();$("#multiple").val(parseInt(e)+1),buyBar.checkMultiple(),buyBar.updateTotalSingle()},minusBtn_Click:function(){var e=$("#multiple").val();parseInt(e)>1&&($("#multiple").val(e-1),buyBar.checkMultiple(),buyBar.updateTotalSingle())},inputBtn_Click:function(){"手工录入"==$(this).text()?($(this).text("常规录入"),ballBar.showInput(),$("#singleInfo").hide(),$("#selectCodeBtn").addClass("selectCodeBtn_selected"),$("#selectArea").removeClass("N-selected"),$(".selectRandomBtn").hide()):($(this).text("手工录入"),$("#singleInfo").show(),ballBar.generateBall(),$("input[name=missHotBtn]:checked").click(),$("#selectArea").addClass("N-selected"),$("#selectCodeBtn").removeClass("selectCodeBtn_selected"),$(".selectRandomBtn").show())},selectCodeBtn_Click:function selectCodeBtn_Click(){if($("#inputTA").length>0){var allCodes=[],str=$.trim($("#inputTA").val());if(0==str.length)return!1;if(1==ps.lotteryType||4==ps.lotteryType){var arr=str.split(/\s+/);if("SXHHZX"==ps.curMethod.name||"ZSHHZX"==ps.curMethod.name||"QSHHZX"==ps.curMethod.name)var re=eval("/^\\d{3}$/");else var re=eval("/^\\d{"+propLen(ps.curMethod.field_def)+"}$/");for(var i in arr)allCodes.push(arr[i].split(""))}else if(2==ps.lotteryType){var arr=str.split(/\n/),re=/^[01]\d$/;for(var i in arr){arr[i]=$.trim(rtrim($.trim(arr[i]),","));var tmp=arr[i].split(" ");if(tmp.length!=array_unique(tmp).length)return parent.layer.alert("您输入的号码有重复，请重新检查输入",{icon:7}),!1;'SDQSZUX'==ps.curMethod.name||'SDQEZUX'==ps.curMethod.name||/SDRX(\d+)/.test(ps.curMethod.name)?allCodes.push([arr[i].split(" ").join("_")]):allCodes.push(arr[i].split(" "))}}var ob={singleNum:1,isDup:0},strPart1='<li><span class="width1" mid="'+ps.curMethod.method_id+'">',strPart2="."+ps.curMethod.cname+'</span><span class="width2">';if(allCodes.length<=1e3)for(var i in allCodes){var ob=isLegalCode(allCodes[i]),singleAmount=number_format(2*ob.singleNum*ps.curMode,2),strPart3='</span><span class="width3">'+ob.singleNum+'注</span><span class="width4">￥'+singleAmount+'</span><span class="xDel">X</span></li>';if(ob.isDup)return parent.layer.alert("您输入的号码有误，请重新检查输入!",{icon:7}),!1;ps.nextProjectCounter++,$(strPart1+ps.nextProjectCounter+strPart2+allCodes[i].join(",")+strPart3).appendTo("#projectList")}else{var allCodesStr='',allProjectsStr='';for(var i in allCodes){allCodesStr&&(allCodesStr+='|'),allCodesStr+=allCodes[i].join(",");var ob=isLegalCode(allCodes[i]);if(ob.isDup)return parent.layer.alert("您输入的号码有误，请重新检查输入!",{icon:7}),!1}var singleAmount=number_format(2*allCodes.length*ps.curMode,2),strPart3='</span><span class="width100px">'+allCodes.length+'注</span><span class="width100px">￥'+singleAmount+'</span><span class="xDel">X</span></li>';ps.nextProjectCounter=allCodes.length,allProjectsStr+=strPart1+strPart2+allCodesStr+strPart3,$(allProjectsStr).appendTo("#projectList")}buyBar.updateTotalSingle(),$("#delTA").click()}else{var ob=ballBar.computeSingle();if(0==ob.singleNum)return!1;ps.nextProjectCounter++;var singleAmount=number_format(2*ob.singleNum*ps.curMode,2);367==ps.curMethod.method_id&&(ob.code='123_234_345_456'),7==ps.lotteryType&&(ob.code=ob.code.replace(/T/g,'10')),$('<li><span class="width1" mid="'+ps.curMethod.method_id+'">'+ps.nextProjectCounter+"."+ps.curMethod.cname+'</span><span class="width2">'+ob.code+'</span><span class="width3">'+ob.singleNum+'注</span><span class="width4">￥'+singleAmount+'</span><span class="xDel">X</span></li>').appendTo("#projectList"),buyBar.updateTotalSingle(),ballBar.reset()}},removeAll:function(){$("#projectList").empty(),ps.nextProjectCounter=0,$("#multiple").val("1"),$("#open_counts").val("1"),buyBar.updateTotalSingle()},updateSingle:function(e){var t=number_format(2*e*ps.curMode,2);$("#betCount").text(e),$("#betAmount").text(t);var a=0==$('#projectList li').length?1:$('#projectList li').length;if(e>0){$("#selectCodeBtn").addClass('selectCodeBtn_selected');var l=$("#totalBetAmount").text(),s=(n=$('#curPrizeSpan').find("option:selected").text()).split('/')[0];$("#totalWin").text(number_format(s*a*$("#multiple").val()-l-t,3))}else{$("#selectCodeBtn").removeClass('selectCodeBtn_selected');var l=$("#totalBetAmount").text(),n=$('#curPrizeSpan').find("option:selected").text(),s=n.split('/')[0];$("#totalWin").text(number_format(s*a*$("#multiple").val()-l,3))}},updateTotalSingle:function(){var e=0;$("#projectList").children("li").each(function(t){var a=$(this).children();e+=parseInt(a.eq(2).text()),a.eq(3).text("￥"+number_format(2*parseInt(a.eq(2).text())*$("#multiple").val()*ps.curMode,2))}),e>0?$("#confirmBtn").addClass('CantapCodeBtn_selected'):($("#confirmBtn").removeClass('CantapCodeBtn_selected'),ps.nextProjectCounter=0);var t=0==$('#projectList li').length?1:$('#projectList li').length;$("#totalBetCount").text(e);var a=number_format(2*e*$("#multiple").val()*ps.curMode,3);$("#totalBetAmount").text(a);var l=$('#curPrizeSpan').find("option:selected").text().split('/')[0];$("#totalWin").text(number_format(l*t*$("#multiple").val()-a,3))},checkMultiple:function(){var e=$("#multiple").val().replace(/^0|[^\d]/g,'');return $("#multiple").val(e),!(parseInt(e)>5e4)||(parent.layer.alert("请输入正确的倍数，最大为50000倍",{icon:7}),$("#multiple").val(5e4),!0)},confirmBtn_Click:function(){var e={},t='';$("#token").val(getRandChar(32));var a=$("#open_counts").val();if(parseInt(a)>1&&(mySlotMachine.playAgain=1),''!=mySlotMachine.buyBarCodes&&1==mySlotMachine.playAgain){t=mySlotMachine.buyBarCodes;l=mySlotMachine.multiple}else{if($("#projectList").children("li").each(function(t){e[$(this).children().eq(0).attr("mid")]||(e[$(this).children().eq(0).attr("mid")]={}),e[$(this).children().eq(0).attr("mid")][t]=$(this).children().eq(1).text()}),$.each(e,function(e,a){t+=e+':',$.each(a,function(e,a){t+=a+'|'}),t=rtrim(t,'|'),t+='#'}),t=rtrim(t,'#'),!ps.canBuy)return parent.layer.alert("该期已截止购买",{icon:7}),!1;if(0==t.length)return parent.layer.alert("请先选择号码再投注",{icon:7}),!1;$("#totalBetAmount").text(),$("#totalBetCount").text();var l=$("#multiple").val();if(!/^[1-9]*[1-9][0-9]*$/.test(l))return parent.layer.alert("请输入正确的倍数，最大为50000倍",{icon:7}),$("#multiple").val("1"),!1}''!=mySlotMachine.fullOpenResult?mySlotMachine.startOpenCode(mySlotMachine.fullOpenResult,t,l):$.post("?c=game&a=play",{op:"buy",lotteryId:ps.lotteryId,issue:ps.curIssueInfo.issue,curRebate:ps.rebateGapList[ps.curPrizeIndex].rebate,modes:ps.curMode,codes:t,multiple:l,openCounts:a,token:$("#token").val()},function(e){mySlotMachine.fullOpenResult=e,mySlotMachine.startOpenCode(e,t,l)},"json").fail(function(e){mySlotMachine.halfClearParams(),parent.layer.alert("购买失败:服务器处理请求失败，请稍后尝试！",{icon:2})})},traceBtn_Click:function(){if($("#traceBtn").attr("mark",1),0==$("#projectList li").length)return parent.layer.alert("请先选择投注号码",{icon:7}),!1;$("#traceBtn").attr('disabled',"true");var e=[];$("#projectList li").each(function(t){-1==$.inArray($(this).find("span:first").attr("mid"),e)&&e.push($(this).find("span:first").attr("mid"))}),$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getTracePage",lotteryId:ps.lotteryId,mids:e.join(",")},cache:!1,dataType:"json",timeout:3e4,success:function(t){if($("#traceBtn").removeAttr("disabled"),0==t.errno){ps.canTraceIssues=t.issues,ps.traceMethodPrize=t.prize,ps.tracePrizeLimit=t.prizeLimit;var a=traceFunc.showTracePage(t.content),l=[250,251,360,368,28,56,101,202,298,34,57,102,203,304,4,52,106,193,274,5,53,107,194,275,81,108,109,195,351,42,75,115,219,312,43,76,116,220,313,38,71,120,214,308,39,72,121,215,309,82,110,122,216,352,86,93,126,228,356,87,94,127,229,357,88,95,128,230,358,47,78,141,222,317,235,236,386,25,155,173,189,24,154,172,188];0!=t.prize&&1==e.length&&-1==$.inArray(parseInt(ps.curMethod.method_id),l)||$("#multipleStyle2").attr("disabled",!0),$("input[name=multipleStyle]").click(traceFunc.multipleStyle_Click),$("#confirmTraceBtn").click(function(){traceFunc.confirmTraceBtn_Click()&&parent.layer.close(a)}),$("#cancelTraceBtn").click(function(){traceFunc.cancelTraceBtn_Click(),parent.layer.close(a)}),$("#startIssue").change(traceFunc.startIssue_Change),$("#traceNum").click(function(){this.focus(),this.select()}).keyup(buyBar.checkMultiple).keyup(traceFunc.traceNum_Keyup),$("#singleNum").text($("#totalBetCount").text()),$("#issuesNum2").text("1"),$("#multipleStyle1").click(),traceFunc.updateTotalMoney(),runTime.traceRemainTimer=window.setInterval(traceFunc.traceRemain_Timer_Handle,1e3)}else alert("系统繁忙，请稍候再试(01)")},error:function(e,t,a){$("#traceBtn").removeAttr("disabled"),-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(alert("您已经退出，请重新登录"),window.location.href="?a=logout"):alert("操作超时，请刷新页面.")}})},selectRandom:function(){var e,t,a=propLen(ps.curMethod.field_def),l={},s=[];switch(ps.curMethod.name){case'WXDW':l.WXDW=1;case'REZX':l.REZX=2;case'RSZX':l.RSZX=3;for(o=0;o<a;o++)s[o]="-";for(var n=[],i=1;i<=l[ps.curMethod.name];i++){count=Math.floor(Math.random()*a+1);h=!1;for(var r in n)if(n[r]===count){h=!0;break}if(h)i--;else{n.push(count),e=$('#field_'+count+' li').length,t=Math.floor(Math.random()*e);m=$("#field_"+count+" li").eq(t).text();s[count-1]=m}}break;case'RSIZX':l.RSIZX=4;for(var o=0;o<a;o++)s[o]="-";for(var n=[],i=1;i<=l[ps.curMethod.name];i++){count=Math.floor(Math.random()*a+1);h=!1;for(var r in n)if(n[r]===count){h=!0;break}if(h)i--;else{n.push(count),e=$('#field_'+count+' li').length,t=Math.floor(Math.random()*e);m=$("#field_"+count+" li").eq(t).text();s[count-1]=m}}break;case'EXZUX':l.EXZUX=[2];case'SXZS':l.SXZS=[2];case'SXZL':l.SXZL=[3];case'QEZUX':l.QEZUX=[2];case'QSZS':l.QSZS=[2];case'QSZL':l.QSZL=[3];case"ZSZS":l.ZSZS=[2];case"ZSZL":l.ZSZL=[3];case'ZUX24':l.ZUX24=[4];case'ZUX12':l.ZUX12=[1,2];case'ZUX6':l.ZUX6=[2];case'ZUX4':l.ZUX4=[1,1];case'ZUX120':l.ZUX120=[5];case'ZUX60':l.ZUX60=[1,3];case'ZUX30':l.ZUX30=[2,1];case'ZUX20':l.ZUX20=[1,2];case'ZUX10':l.ZUX10=[1,1];case'ZUX5':l.ZUX5=[1,1];for(var c=[],i=1;i<=a;i++){var u=[],p="";e=parseInt($('#field_'+i+' li').length);for(var d=1;d<=l[ps.curMethod.name][i-1];d++){var h=!1;t=Math.floor(Math.random()*e);for(var r in c)if(c[r]===t){h=!0;break}h?d--:(c.push(t),u.push(t),p=u.sort().join(''))}s.push(p)}break;default:for(i=1;i<=a;i++){e=parseInt($('#field_'+i+' li').length),t=Math.floor(Math.random()*e);var m=$("#field_"+i+" li").eq(t).text();s.push(m)}}var f=isLegalCode(s),y=s.join(",");if(0==f.singleNum)return!1;ps.nextProjectCounter++;var v=number_format(2*f.singleNum*ps.curMode,2);$('<li><span class="width80px" mid="'+ps.curMethod.method_id+'">'+ps.nextProjectCounter+"."+ps.curMethod.cname+'</span><span class="width60px">'+y+'</span><span class="width100px">'+f.singleNum+'注</span><span class="width100px">￥'+v+'</span><span class="xDel">X</span></li>').appendTo("#projectList"),buyBar.updateTotalSingle()},selectRandomBtn_Click:function(){$(this).attr('disabled','true');var e,t=$(this).attr('num');for(e=1;e<=t;e++)buyBar.selectRandom();$(this).removeAttr('disabled')}},traceFunc={multipleStyle_Click:function(){$("#startIssue").get(0).selectedIndex=0,$("#traceNum").val(1),1==$(this).val()?($(".style1BodyMultiple").live("click",function(){this.focus(),this.select()}).live("keyup",buyBar.checkMultiple).live("keyup",traceFunc.style1BodyMultiple_Keyup),traceFunc.updateStyle1(),$("#multipleStyle1DIV").show(),$("#multipleStyle2DIV").hide()):($("#startMultiple").click(function(){this.focus(),this.select()}),$("#beitouToolSmainbtzk input").click(function(){$(this).parent().click()}).focus(function(){this.select()}),$("#beitouToolSmainbtzk li").click(function(){$(this).addClass("checked").siblings().removeClass("checked"),$(this).find("input[name=profitStyle]").attr("checked",!0)}),$("#generalPlanBtn").click(traceFunc.generalPlanBtn_Click),$("#issuesNum2").text("1"),$("#style2Body").empty(),$("#startMultiple").val("1"),$("input[name=totalProfitRate]").val("10"),$("input[name=first5Rate]").val("5"),$("input[name=first5RateValue]").val("10"),$("input[name=laterRateValue]").val("5"),$("input[name=totalProfit]").val("100"),$("input[name=first5Profit]").val("5"),$("input[name=first5ProfitValue]").val("100"),$("input[name=laterProfitValue]").val("50"),$("#beitouToolSmainbtzk li:first").click(),$("#multipleStyle1DIV").hide(),$("#multipleStyle2DIV").show())},startIssue_Change:function(){"1"==$("input[name=multipleStyle]:checked").val()&&traceFunc.updateStyle1()},traceNum_Keyup:function(){"1"==$("input[name=multipleStyle]:checked").val()&&traceFunc.updateStyle1()},traceRemain_Timer_Handle:function(){var e=subTime(ps.curRemainTime);if(ps.curRemainTime>0)$("#remainTimerLabel").text(e.hour+":"+e.minute+":"+e.second),$("#traceBtn").attr("mark",0);else{clearInterval(runTime.traceRemainTimer);var t=subTime(ps.curWaitOpenTime);if($("#remainTimerLabel").text(t.hour+":"+t.minute+":"+t.second),runTime.traceWaitOpenTimer=window.setInterval(traceFunc.traceWaitOpen_Timer_Handle,1e3),parent.layer.alert("第"+ps.curIssueInfo.issue+"期投注时间已结束，投注内容将进入到下一期！",{icon:7}),1!=$("#traceBtn").attr("mark")){$("#startIssue").children(":first").remove(),$("#startIssue").children(":first").text($("#startIssue").children(":first").text()+"(当前期)");var a=[];$(".style1BodyMultiple").each(function(){a.push(this.value)}),traceFunc.updateStyle1(),$(".style1BodyMultiple").each(function(){this.value=a.pop()})}}},traceWaitOpen_Timer_Handle:function(){var e=subTime(ps.curWaitOpenTime);$("#remainTimerLabel").text(e.hour+":"+e.minute+":"+e.second),ps.curWaitOpenTime<=0&&(clearInterval(runTime.traceWaitOpenTimer),runTime.traceRemainTimer=window.setInterval(traceFunc.traceRemain_Timer_Handle,1e3))},style1BodyMultiple_Keyup:function(){var e=parseInt($(this).val());(isNaN(e)||e<1||e>99999)&&(e=1),/\w+_(\d+)/.test($(this).attr("id"));var t=RegExp.$1;if(0==t)a=0;else var a=parseFloat($("#totalMoney_"+(t-1)).text());for(;t<=$("#style1Body li").length;){$("#style1BodyMultiple_"+t).val(e);var l=parseInt($("#singleNum").text())*e*2*ps.curMode;a+=l,$("#curMoney_"+t).text(number_format(l,2)),$("#totalMoney_"+t).text(number_format(a,2)),t++}traceFunc.updateTotalMoney()},updateStyle1:function(){var e=-1;if($.each(ps.canTraceIssues,function(t,a){a==$("#startIssue").val()&&(e=t)}),-1==e)throw alert("数据出错"),"数据出错";isNaN(parseInt($("#traceNum").val()))&&$("#traceNum").val("1");var t=ps.canTraceIssues.slice(e,e+parseInt($("#traceNum").val()));t.length<$("#traceNum").val()&&(parent.layer.alert("最多只能追"+t.length+"期",{icon:7}),$("#traceNum").val(t.length)),$("#style1Body").empty();var a,l=0;$.each(t,function(e,t){a=2*parseInt($("#singleNum").text())*ps.curMode,l+=a;var s='<li id="traceIssueLI_'+e+'"><span id="traceIssue_'+e+'">'+t+'</span><span><input type="text" value="1" id="style1BodyMultiple_'+e+'" class="beitouToolsinput style1BodyMultiple" maxlength="5" /></span><span id=curMoney_'+e+">"+number_format(a,2)+"</span><span id=totalMoney_"+e+">"+number_format(l,2)+"</span></li>";$("#style1Body").append(s),$(".style1BodyMultiple").bind("click",function(){this.focus(),this.select()}).bind("keyup",buyBar.checkMultiple).bind("keyup",traceFunc.style1BodyMultiple_Keyup)}),traceFunc.updateTotalMoney()},confirmTraceBtn_Click:function(){var e,t,a,l,s,n;if($("#projectList").children("li").each(function(i){e=$(this).children(),l=e.eq(0).attr("mid"),s=e.eq(1).text(),n=!1,a||(a=l,t=l+":",n=!0),a!=l?(t+="#"+l+":",a=l,t+=s):t+=1==n?s:"|"+s}),!ps.canBuy)return parent.layer.alert("该期已截止购买",{icon:7}),!1;if(0==t.length)return parent.layer.alert("请先选择号码再投注",{icon:7}),!1;var i=[];"1"==$("input[name=multipleStyle]:checked").val()?$("#style1Body li").each(function(e){var t=$(this).find("span:eq(0)").text(),a=$(this).find("input").val();i.push({issue:t,multiple:a})}):$("#style2Body li").each(function(e){var t=$(this).find("span:eq(0)").text(),a=$(this).find("span:eq(1)").text();i.push({issue:t,multiple:a})});var r=0,o=$("#traceTotalAmount").text(),c=$("input[name=stopOnWin]").attr("checked")?1:0,u='<div id="buy_message">请确认以下投注内容：<br>************************<br>是否追号：是<br>单倍注数：'+$("#totalBetCount").text()+"注<br>总 金 额：￥"+o+"<br>超始期号："+i[0].issue+"<br>追号期数："+i.length+"<br>模&nbsp;&nbsp;式："+(1==ps.curMode?"元":.1==ps.curMode?"角":"分")+"模式<br>************************<br></div>";return traceFunc.destroyTracePage(),parent.layer.confirm(u,{icon:7},function(e){if(7==ps.lotteryType&&(t=t.replace(/10/g,'T')),1==(r+=1)){$.post("?c=game&a=play",{op:"buy",lotteryId:ps.lotteryId,issue:ps.curIssueInfo.issue,curRebate:ps.rebateGapList[ps.curPrizeIndex].rebate,modes:ps.curMode,codes:t,traceData:i,stopOnWin:c},function(t){if(0==t.errno){buyBar.removeAll();var a='<div id="buy_success_message">追号订单成功!<br>************************<br>订单编号：'+t.pkgnum+"<br>起始期号："+i[0].issue+"<br>追号期数："+i.length+"<br>追号总额：￥"+o+"<br>模&nbsp;&nbsp;式："+(1==ps.curMode?"元":.1==ps.curMode?"角":"分")+"模式<br>************************<br></div>";parent.layer.close(e),parent.layer.alert(a,{icon:1}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")})}else parent.layer.close(e),parent.layer.alert("追号失败:"+t.errstr,{icon:2})},"json").fail(function(){parent.layer.close(e),layer.alert("购买失败:服务器处理请求失败，请稍后尝试！",{icon:2})});var a=setInterval(function(){0==(r=0)&&clearInterval(a)},5e3)}parent.$('.xubox_botton').empty(),parent.$('.xubox_botton').html('<div class="LoadingShow"><span class="Loading_icon"></span><span class="Loading_Font">投注中，请稍后...</span></div>')}),parent.$('.xubox_yes').focus(),parent.$('.xubox_yes').one('keyup',function(e){var t=e.keyCode?e.keyCode:e.which;32==t&&parent.$('.xubox_yes').trigger("click"),27==t&&parent.$('.xubox_no').trigger("click")}),!0},cancelTraceBtn_Click:function(){traceFunc.destroyTracePage()},showTracePage:function(e){var t=parent.layer.open({type:1,title:'追号管理',offset:['50px',''],area:['700px','auto'],content:e,success:function(e){$("#startIssue").children(":first").text($("#startIssue").children(":first").text()+"(当前期)")},close:traceFunc.cancelTraceBtn_Click});return $(document).one('keyup',function(e){27==(e.keyCode?e.keyCode:e.which)&&(traceFunc.cancelTraceBtn_Click(),parent.layer.close(t))}),t},destroyTracePage:function(){clearInterval(runTime.traceRemainTimer),clearInterval(runTime.traceWaitOpenTimer)},updateTotalMoney:function(){var e=0;"1"==$("input[name=multipleStyle]:checked").val()?($("#style1Body li").each(function(t){e+=parseInt($(this).find("input").val())}),$("#issuesNum2").text($("#style1Body li").length)):($("#style2Body li").each(function(t){e+=parseInt($(this).find("span:eq(1)").text())}),$("#issuesNum2").text($("#style2Body li").length)),$("#traceTotalAmount").text(number_format(parseInt($("#singleNum").text())*e*2*ps.curMode,2))},generalPlanBtn_Click:function(){var e=function(e,t,a,l,s){if(e=isNaN(parseInt(e))?-1:parseInt(e),t=isNaN(parseInt(t))?-1:parseInt(t),a=isNaN(parseFloat(a))?-1:parseFloat(a),l=isNaN(parseFloat(l))?-1:parseFloat(l),s=parseFloat(s),e<0||t<0||a<0||l<0||s<=0)return 0;var n=0;return a>0&&(t>0?(n=(t/100+1)*l/(s-a*(t/100+1)),n=Math.ceil(round(n,3))):n=1,n>0&&n<e&&(n=e)),n},t=-1;if($.each(ps.canTraceIssues,function(e,a){a==$("#startIssue").val()&&(t=e)}),-1==t)throw alert("数据出错"),"数据出错";isNaN(parseInt($("#traceNum").val()))&&$("#traceNum").val("1");var a=ps.canTraceIssues.slice(t,t+parseInt($("#traceNum").val()));a.length<$("#traceNum").val()&&(parent.layer.alert("最多只能追"+a.length+"期",{icon:7}),$("#traceNum").val(a.length)),$("#style2Body").empty();var l,s,n=[],i=0,r=2*parseInt($("#singleNum").text())*ps.curMode,o=ps.traceMethodPrize*(ps.rebateGapList[ps.curPrizeIndex].prize/(ps.maxCombPrize*ps.prizeRate))*ps.curMode;$.each(a,function(t,a){if(1==$("input[name=profitStyle]:checked").val())if(0==t){if(l=parseInt($("#startMultiple").val()),s=l*parseInt($("#singleNum").text())*2*ps.curMode,(l*o-s)/s*100<$("input[name=totalProfitRate]").val())return parent.layer.alert("该计划无法实现，请调整目标",{icon:7}),!1}else l=e($("#startMultiple").val(),$("input[name=totalProfitRate]").val(),r,i,o);else if(2==$("input[name=profitStyle]:checked").val())if(0==t){if(l=parseInt($("#startMultiple").val()),s=l*parseInt($("#singleNum").text())*2*ps.curMode,(l*o-s)/s*100<$("input[name=first5RateValue]").val())return parent.layer.alert("该计划无法实现，请调整目标",{icon:7}),!1}else l=t<$("input[name=first5Rate]").val()?e($("#startMultiple").val(),$("input[name=first5RateValue]").val(),r,i,o):e($("#startMultiple").val(),$("input[name=laterRateValue]").val(),r,i,o);else 3==$("input[name=profitStyle]:checked").val()?(l=Math.ceil(round((parseInt($("input[name=totalProfit]").val())+i)/(o-2*parseInt($("#singleNum").text())*ps.curMode),3)))<$("#startMultiple").val()&&(l=$("#startMultiple").val()):4==$("input[name=profitStyle]:checked").val()&&(l=t<$("input[name=first5Profit]").val()?Math.ceil(round((parseInt($("input[name=first5ProfitValue]").val())+i)/(o-2*parseInt($("#singleNum").text())*ps.curMode),3)):Math.ceil(round((parseInt($("input[name=laterProfitValue]").val())+i)/(o-2*parseInt($("#singleNum").text())*ps.curMode),3)));return 0==l?(parent.layer.alert("您输入的参数有误，必须为正整数",{icon:7}),!1):l<0?(parent.layer.alert("该计划不可能实现，请调整目标",{icon:7}),!1):l*o>ps.tracePrizeLimit?(parent.layer.alert("该计划超出无法实现，请调整目标",{icon:7}),!1):(s=l*parseInt($("#singleNum").text())*2*ps.curMode,i+=s,void n.push({issue:a,multiple:l,curMoney:number_format(s,2),totalMoney:number_format(i,2),curPrize:number_format(l*o,2),totalProfit:number_format(l*o-i,2),totalProfitRate:round((l*o-i)/i,2)}))}),traceFunc._showPlan(n)},_showPlan:function(e){$.each(e,function(e,t){var a='<li><span class="spanWidth90px">'+t.issue+'</span><span class="spanWidth50px">'+t.multiple+'</span><span class="spanWidth70px">'+t.curMoney+'</span><span class="spanWidth70px">'+t.totalMoney+'</span><span class="spanWidth70px">'+t.curPrize+'</span><span class="spanWidth70px">'+t.totalProfit+'</span><span class="spanWidth70px">'+Math.round(100*t.totalProfitRate)+"%</span></li>";$("#style2Body").append(a)}),traceFunc.updateTotalMoney()}},initDrawBar=function(){return ps.canBuy=!0,!0},drawBar={init:function(){return!0},getCurIssue:function(e){$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getCurIssue",lotteryId:ps.lotteryId},cache:!1,dataType:"json",timeout:3e4,success:function(t){0==t.errno?(ps.curIssueInfo=t.issueInfo,ps.curServerTime=t.serverTime,ps.curRemainTime=getTS(ps.curIssueInfo.end_time)-getTS(ps.curServerTime),ps.curWaitOpenTime=8,ps.lastIssueInfo=t.lastIssueInfo,"function"==typeof e&&e()):alert("系统繁忙，请稍候再试(02)")},error:function(e,t,a){-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(top.layer.alert("您已经超时退出，请重新登录",{icon:7}),window.location.href="?a=logout"):top.layer.alert("操作超时，请刷新页面..",{icon:7})}})},showCurIssue_Timer:function(){$("#thisIssueSpan").text(ps.curIssueInfo.issue),$("#thisIssueSpan2").text(ps.curIssueInfo.issue);var e=subTime(--ps.curRemainTime);if(ps.curRemainTime>=0)$("#thisIssueRemainTime").text(e.hour+":"+e.minute+":"+e.second),$("#thisIssueTimerIcon").removeClass("lock").addClass('clock');else{clearInterval(runTime.remainTimer),layer.alert(ps.curIssueInfo.issue+'期销售已截止，请进入下一期购买',{icon:7}),$('#thisIssueTimerIcon').removeClass('clock').addClass('lock');var t=subTime(ps.curWaitOpenTime);$('#thisIssueRemainTime').text(t.hour+":"+t.minute+":"+t.second),ps.canBuy=!1,runTime.waitOpenTimer=window.setInterval(drawBar.waitOpen_Timer,1e3)}},waitOpen_Timer:function(){--ps.curWaitOpenTime;var e=subTime(ps.curWaitOpenTime);$("#thisIssueRemainTime").text(e.hour+":"+e.minute+":"+e.second),ps.curWaitOpenTime<0&&(clearInterval(runTime.waitOpenTimer),drawBar.getCurIssue(drawBar.init))},getLastOpen_Timer:function(){ps.getLastOpenTime++,ps.getLastOpenTime%10==0&&$.ajax({url:"?c=game&a=play",type:"POST",data:{op:"getLastIssueCode",lotteryId:ps.lotteryId,issue:ps.lastIssueInfo.issue},cache:!1,dataType:"json",timeout:3e4,success:function(e){if(0==e.errno){if(void 0!==e.issueInfo.code){clearInterval(runTime.getLastOpenTimer),ps.getLastOpenTime=0,ps.lastIssueInfo=e.issueInfo;var t=drawBar.getMoreInfo(e.issueInfo.code);if(e.issueInfo.prop=t,ps.todayDrawList.unshift(e.issueInfo),$("#todayDrawBtn").hasClass("cur")){var a=ps.todayDrawList[0],l='<ul><li class="width80px">'+a.issue+'</li><li class="width60px">'+a.code+'</li><li class="width53px">'+a.prop.qszt+'</li><li class="width53px">'+a.prop.hszt+"</li></ul>";$("#todayIssuesBody").prepend(l)}drawBar.showLastDraw()}}else alert("系统繁忙，请稍候再试(03)")},error:function(e,t,a){-1!=a.indexOf("a=logout")||-1!=a.indexOf("a=login")?(top.layer.alert("您已经超时退出，请重新登录",{icon:7}),window.location.href="?a=logout"):top.layer.alert("操作超时，请刷新页面...",{icon:7})}})},showLastDraw:function(){var e=ps.todayDrawList[0];$("#lastIssueSpan").text(ps.lastIssueInfo.issue);var t;if(ps.lastIssueInfo.issue==e.issue){if(1==ps.lotteryType){a=e.code.split("");t="<ul><li>三星形态:[<span>"+e.prop.hszt+"</span>]</li><li>三星和值:[<span>"+e.prop.hshz+"</span>]</li><li>二星和值:[<span>"+e.prop.hehz+'</span>]</li><li class="last">大小单双:[<span>'+e.prop.dxds+"</span>]</li></ul>"}else if(2==ps.lotteryType)t="<ul><li>第一位：<span>"+(a=e.code.split(" "))[0]+"</span></li><li>第二位：<span>"+a[0]+","+a[1]+"</span></li></ul><ul><li>第三位：<span>"+a[0]+","+a[1]+","+a[2]+"</span></li></ul>";else if(4==ps.lotteryType){a=e.code.split("");t="<ul><li>三星形态:[<span>"+e.prop.qszt+"</span>]</li><li>三星和值:[<span>"+e.prop.qshz+"</span>]</li></ul>"}else if(6==ps.lotteryType){var a=e.code.split(""),l=parseInt(a[0])+parseInt(a[1])+parseInt(a[2]);t='<ul><li class="last">形态：[ <span class="bs">'+(l>10?'大':'小')+'</span> <span class="oe">'+(l%2?'单':'双')+'</span> ]&nbsp;&nbsp;和值：[ <span class="num">'+l+'</span> ]</li></ul>',$("#openCode").html(e.code)}else{if(7!=ps.lotteryType)throw new exception('无效的数据引用1');a=e.code.split(" ");t='<ul><li class="last">形态：'+drawBar.getMoreInfo(e.code).pkzt+'</li></ul>'}var s=0;window.setTimeout(function e(){if($("#thisIssueNumUL").children(".pendingBall").length>0){var t=$("#thisIssueNumUL").children(".pendingBall").first();window.setTimeout(function(){t.removeClass("pendingBall").text(a[s++]),2==ps.lotteryType&&t.addClass("sd115_Ball"),e()},500)}},100)}else $("#thisIssueNumUL").children().addClass("pendingBall").removeClass("sd115_Ball"),t='<ul><li>三星形态:[<span></span>]</li><li>二星和值:[<span></span>]</li><li>三星和值:[<span></span>]</li><li class="last">大小单双:[<span></span>]</li></ul>';$("#thisIssueMoreInfo").html(t)},todayDrawBtn_Click:function(){if($("#todayIssuesHead").empty().show(),$("#todayIssuesBody").empty().show(),$("#prizeScrollContent").hide(),1==ps.lotteryType)$("#todayIssuesHead").html('<li class="width80px">期号</li><li class="width60px">开奖号</li><li class="width55px">前3组态</li><li class="width55px">后3组态</li>');else if(2==ps.lotteryType)$("#todayIssuesHead").html('<li class="width247px">期号</li><li class="width247px">开奖号</li>');else if(4==ps.lotteryType)$("#todayIssuesHead").html('<li class="width80px">期号</li><li class="width60px">开奖号</li><li class="width55px">三星组态</li><li class="width55px">三星和值</li>');else if(6==ps.lotteryType)$("#todayIssuesHead").html('<li class="width80px">期号</li><li class="width60px">开奖号</li><li class="width55px">和值</li><li class="width55px">形态</li>');else{if(7!=ps.lotteryType)throw exception('unknown lt type');$("#todayIssuesHead").html('<li class="width80px">期号</li><li style="width:120px">开奖号</li><li class="width55px">形态</li>')}$("#todayIssuesBody").empty(),$.each(ps.todayDrawList,function(e,t){var a='<ul><li class="width80px">'+t.issue+'</li><li class="width60px">'+t.code+'</li><li class="width53px">'+t.prop.qszt+'</li><li class="width53px">'+t.prop.hszt+"</li></ul>";$("#todayIssuesBody").append(a)})},prizeRankBtn_Click:function(){$("#todayIssuesHead").empty().hide(),$("#todayIssuesBody").empty().hide(),$.post("?c=game&a=play",{op:"getPrizeRank",lotteryId:ps.lotteryId},function(e){0==e.errno?0==e.data.length?$('<div class="todayNoBet">暂时没有记录！</div>').appendTo("#prizeScrollContent"):($("#prizeScrollContent").empty(),$.each(e.data,function(e,t){$('<ul><li><span>'+t.nick_name+"</span> 喜中 <em>"+number_format(t.total_prize,2)+"</em>元</li></ul>").appendTo($("#prizeScrollContent"))}),$("#prizeScrollContent").html($("#prizeScrollContent").html()+$("#prizeScrollContent").html()).show(),0==runTime.scollTopIntervalTimer&&(runTime.scollTopIntervalTimer=window.setInterval(drawBar.scrollPrizeRank,100),$("#prizeScrollContent").mouseover(function(){clearInterval(runTime.scollTopIntervalTimer)}).mouseout(function(){runTime.scollTopIntervalTimer=window.setInterval(drawBar.scrollPrizeRank,100)}))):alert("暂时没有数据！")},"json")},todayBuyBtn_Click:function(){$.post("?c=game&a=play",{op:"getCurContextIssues",lotteryId:ps.lotteryId},function(e){$("#todayIssuesHead").empty().show(),$("#todayIssuesBody").empty().show(),$("#prizeScrollContent").hide(),0==e.errno?($.each(e.issueInfos,function(e,t){$('<li name="'+t.issue+'" class="todayRecentIssues"'+(2==e?" style='width:80px;'":"")+'>'+helper.getNumByIssue(t.issue)+(2==e?"(当前期)":"")+"</li>").click(function(){$(this).addClass("yellow").siblings().removeClass("yellow"),$.post("?c=game&a=play",{op:"getBuyRecords",lotteryId:ps.lotteryId,issue:$(this).attr("name")},function(e){0==e.errno?($("#todayIssuesBody").empty(),$('<ul><li class="C1">玩法类型</li><li class="C2">投注内容</li><li class="C3">倍数</li><li class="C4">金额</li><li class="C5">状态</li></ul>').appendTo("#todayIssuesBody"),0==e.prj.length?$('<div class="todayNoBet">暂时没有记录！</div>').appendTo("#todayIssuesBody"):$.each(e.prj,function(e,t){7==ps.lotteryType&&(t.code=t.code.replace(/T/g,'10')),$('<ul><li class="C1"><a href="javascript:showPackageDetail(\''+t.wrapId+'\');">'+t.methodName+'</a></li><li class="C2">'+t.code+'</li><li class="C3">'+t.multiple+'</li><li class="C4">'+t.amount+'</li><li class="C5">'+t.prizeStatus+"</li></ul>").click(function(){}).appendTo("#todayIssuesBody")})):alert("系统繁忙，请稍候再试(04)")},"json")}).appendTo("#todayIssuesHead")}),$("#todayIssuesHead li:eq(2)").click()):alert("系统繁忙，请稍候再试(05)")},"json")},scrollPrizeRank:function(){var e=$("#prizeScrollContent")[0];e.scrollTop+=1,e.scrollTop>=$("#prizeScrollContent")[0].scrollHeight/2&&(e.scrollTop=0)},getMoreInfo:function(e){var t={},a=e.split("");return t.qshz=parseInt(a[0])+parseInt(a[1])+parseInt(a[2]),t.qszt=drawBar.zutai(a[0],a[1],a[2]),t.hshz=parseInt(a[2])+parseInt(a[3])+parseInt(a[4]),t.hszt=drawBar.zutai(a[2],a[3],a[4]),t.hehz=parseInt(a[3])+parseInt(a[4]),t.dxds=drawBar.dxds(a[3],a[4]),t},zutai:function(e,t,a){return e==t&&e==a&&t==a?"豹子":e==t||e==a||t==a?"组三":"组六"},dxds:function(e,t){var a=[],l=[];return a.push(e>=5?"大":"小"),a.push(e%2==1?"单":"双"),l.push(t>=5?"大":"小"),l.push(t%2==1?"单":"双"),[a[0]+l[0],a[0]+l[1],a[1]+l[0],a[1]+l[1]].join(",")}};if(!verifyParams())return parent.layer.alert("数据初始化失败",{icon:2}),!1;initPrizeBar(),initModesBar(),initMethodBar(),initMissHotBar(),initBuyBar(),initDrawBar();var isLegalCode=function(e){if(0==allHasValue(e).charsNum)return{singleNum:0,isDup:0};var t,a=0,l=0;switch(ps.curMethod.name){case'SXZX':case"ZSZX":case'QSZX':l=(a=e[0].length*e[1].length*e[2].length)>1?1:0;break;case'SXZS':case"ZSZS":case'QSZS':l=(a=e[0].length*(e[0].length-1))>2?1:0;break;case'SXZL':case"ZSZL":case'QSZL':l=(a=e[0].length*(e[0].length-1)*(e[0].length-2)/helper.factorial(3))>1?1:0;break;case'SXLX':case"ZSLX":case'QSLX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var s=0,n=0,i=0;s=e[0].length*e[1].length*e[2].length,n=e[1].length*e[2].length,i=e[2].length,l=(a=s+n+i)>3?1:0;break;case'SXBD':case"ZSBD":case'QSBD':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXBD[t]}),l=t.length>1?1:0;break;case'SXHHZX':case"ZSHHZX":case'QSHHZX':l=(a=e[0].length*e[1].length*e[2].length)>1?1:0;break;case'EXZX':case'QEZX':l=(a=e[0].length*e[1].length)>1?1:0;break;case'EXZUX':case'QEZUX':l=(a=e[0].length*(e[0].length-1)/2)>1?1:0;break;case'EXLX':case'QELX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var n=0,i=0;n=e[0].length*e[1].length,i=e[1].length,l=(a=n+i)>2?1:0;break;case'EXBD':case'QEBD':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.EXBD[t]}),l=t.length>1?1:0;break;case'YXZX':l=(a=e[0].length)>1?1:0;break;case'WXDW':for(c=0;c<5;c++)'-'!=e[c]&&(a+=e[c].length);l=a>1?1:0;break;case'SXDW':l=(a=e[0].length+e[1].length+e[2].length)>1?1:0;break;case'EMBDW':case'QSEMBDW':case'ZSEMBDW':case'SXEMBDW':case'WXEMBDW':a=e[0].length*(e[0].length-1)/2,l=0;break;case'WXSMBDW':a=e[0].length*(e[0].length-1)*(e[0].length-2)/6,l=0;break;case'EXDXDS':case'QEDXDS':a=e[0].length*e[1].length==1?1:0,l=0;break;case'SXDXDS':a=e[0].length*e[1].length*e[2].length==1?1:0,l=0;break;case'YMBDW':case'ZSYMBDW':case'SXYMBDW':case'WXYMBDW':case'QSYMBDW':a=e[0].length,l=0;break;case'SXHZ':case"ZSHZ":case'QSHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXHZ[t]}),l=t.length>1?1:0;break;case'EXHZ':case'QEHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.EXHZ[t]}),l=t.length>1?1:0;break;case'SXZXHZ':case'QSZXHZ':t=e[0].split('_'),$.each(t,function(e,t){a+=helper.SXZXHZ[t]}),l=t.length>1?1:0;break;case'SIXZX':case'QSIZX':l=(a=e[0].length*e[1].length*e[2].length*e[3].length)>1?1:0;break;case'WXZX':l=(a=e[0].length*e[1].length*e[2].length*e[3].length*e[4].length)>1?1:0;break;case'WXLX':if(0==allHasValue(e).flag)return{singleNum:0,isDup:0};var r=0,s=0,n=0,i=0;r=e[0].length*e[1].length*e[2].length*e[3].length*e[4].length,s=e[2].length*e[3].length*e[4].length,n=e[3].length*e[4].length,i=e[4].length,l=(a=r+s+n+i)>4?1:0;break;case'REZX':for(c=0;c<4;c++)if('-'!=e[c])for(u=c+1;u<5;u++)'-'!=e[u]&&(a+=e[c].length*e[u].length);l=a>1?1:0;break;case'RSZX':for(c=0;c<3;c++)if('-'!=e[c])for(u=c+1;u<4;u++)if('-'!=e[u])for(p=u+1;p<5;p++)'-'!=e[p]&&(a+=e[c].length*e[u].length*e[p].length);l=a>1?1:0;break;case'RSIZX':for(var o=0;o<2;o++)if('-'!=e[o])for(var c=o+1;c<3;c++)if('-'!=e[c])for(var u=c+1;u<4;u++)if('-'!=e[u])for(var p=u+1;p<5;p++)'-'!=e[p]&&(a+=e[o].length*e[c].length*e[u].length*e[p].length);l=a>1?1:0;break;case'SDQSZX':if(3!=e.length)return{singleNum:0,isDup:0};d=helper.expandLotto(e);l=(a=d.length)>1?1:0;break;case'SDQEZX':if(2!=e.length)return{singleNum:0,isDup:0};var d=helper.expandLotto(e);l=(a=d.length)>1?1:0;break;case'SDQSZUX':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)/helper.factorial(3))>1?1:0;break;case'SDQEZUX':t=e[0].split('_'),l=(a=t.length*(t.length-1)/2)>1?1:0;break;case'SDRX1':t=e[0].split('_'),l=(a=t.length)>1?1:0;break;case'SDRX2':t=e[0].split('_'),l=(a=t.length*(t.length-1)/2)>1?1:0;break;case'SDRX3':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)/6)>1?1:0;break;case'SDRX4':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)/24)>1?1:0;break;case'SDRX5':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)/120)>1?1:0;break;case'SDRX6':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)/720)>1?1:0;break;case'SDRX7':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)*(t.length-6)/5040)>1?1:0;break;case'SDRX8':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)*(t.length-3)*(t.length-4)*(t.length-5)*(t.length-6)*(t.length-7)/40320)>1?1:0;break;case'SDQSBDW':t=e[0].split('_'),l=(a=t.length)>1?1:0;break;case'SDQSDWD':$.each(e,function(e,l){''!=l&&(t=l.split('_'),a+=t.length)}),l=a>3?1:0;break;case'SDDDS':case'SDCZW':a=1,l=1;break;case'YFFS':case'HSCS':case'SXBX':case'SJFC':l=(a=e[0].length)>1?1:0;break;case'ZUX120':e[0].length>4&&(a=5===e[0].length?1:helper.factorial(e[0].length)/(120*helper.factorial(e[0].length-5))),l=a>1?1:0;break;case'ZUX24':e[0].length>3&&(a=helper.factorial(e[0].length)/(24*helper.factorial(e[0].length-4))),l=a>1?1:0;break;case'ZUX6':e[0].length>1&&(a=helper.factorial(e[0].length)/(2*helper.factorial(e[0].length-2))),l=a>1?1:0;break;case'ZUX10':case'ZUX5':case'ZUX4':if(e[0].length>0&&e[1].length>0){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>0&&(a+=helper.factorial(m)/helper.factorial(m-1))}}l=a>1?1:0;break;case'ZUX20':case'ZUX12':if(e[0].length>0&&e[1].length>1){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>1&&(a+=helper.factorial(m)/(2*helper.factorial(m-2)))}}l=a>1?1:0;break;case'ZUX60':if(e[0].length>0&&e[1].length>2){h=e[1].length;for(c=0;c<e[0].length;c++){m=h;e[1].indexOf(e[0].substr(c,1))>-1&&(m=h-1),m>2&&(a+=helper.factorial(m)/(6*helper.factorial(m-3)))}}l=a>1?1:0;break;case'ZUX30':if(e[0].length>1&&e[1].length>0){var h=e[0].length;for(c=0;c<e[1].length;c++){var m=h;e[0].indexOf(e[1].substr(c,1))>-1&&(m=h-1),m>1&&(a+=helper.factorial(m)/(2*helper.factorial(m-2)))}}l=a>1?1:0;break;case'JSETDX':if(2!=e.length)return{singleNum:0,isDup:0};var f=e[0].length?e[0].split('_'):[],y=e[1].length?e[1].split(''):[];l=(a=f.length*y.length)>1?1:0;break;case'JSETFX':t=e[0].split('_'),l=(a=t.length)>1?1:0;break;case'JSHZ':t=e[0].split('_'),a=t.length,l=t.length>1?1:0;break;case'JSSTTX':case'JSSLTX':l=(a=1)>1?1:0;break;case'JSEBT':v=e[0].length;a=(v-1)*v/2,l=v>2?1:0;break;case'JSSTDX':t=e[0].split('_'),a=t.length,l=t.length>1?1:0;break;case'JSSBT':var v=e[0].length;a=(v-1)*(v-2)*v/6,l=v>3?1:0;break;case'PKSZ':case'PKBZ':case'PKDZ':case'PKTH':case'PKTHS':case'PKBX':case'PKRX1':t=e[0].split('_'),l=(a=t.length)>1?1:0;break;case'PKRX2':t=e[0].split('_'),l=(a=t.length*(t.length-1)/2)>1?1:0;break;case'PKRX3':t=e[0].split('_'),l=(a=t.length*(t.length-1)*(t.length-2)/6)>1?1:0;break;case'PKRX4':t=e[0].split('_'),a=t.length;g=t.length;l=(a=g*(g-1)*(g-2)*(g-3)/24)>1?1:0;break;case'PKRX5':g=(t=e[0].split('_')).length;l=(a=g*(g-1)*(g-2)*(g-3)*(g-4)/120)>1?1:0;break;case'PKRX6':var g=(t=e[0].split('_')).length;l=(a=g*(g-1)*(g-2)*(g-3)*(g-4)*(g-5)/720)>1?1:0;break;default:throw"unknown method2 "+ps.curMethod.name}return{singleNum:a,isDup:l}}}}(jQuery);